*** Settings ***
Force Tags        functional    regression
Resource          ../../resources/imports.txt
Resource          resources/admin-score.txt
Resource          ../resources/common.txt
Resource          ../personalization-score/resources/personalization-score.txt

*** Test Cases ***
FNC_001 Score Is Successfully Retrieved With Multiple AP, CP And Boost Data With Multiple Match
    Delete All Versions Redis Keys
    Generate Test Data For Traveler Preference 2    V1,S:0986
    Generate Test Data For Features    app_id=Desktop_Amadeus    oag_value=false    cp_pass=false    default_tp=false
    Clear Cache    personalizationConfig
    Generate Test Variables For Get Personalization Admin Score    tp_boost=0.1    ap_boost=0.2    cp_boost=1    csu_guid=B:4567    iss_country=PH    origin=MNL
    ...    destination=NRT    dep_date=20181208    app_id=Desktop_Amadeus
    Create TP Meta Data
    Create Test Data For Metadata    app_id=Desktop_Amadeus
    # Multiple Matching AP Data
    Generate Test Variables And Data For Agency Preferences    ap_carrier_code=AA    ap_iss_country=C_PH    ap_origin=A_MNL    ap_destination=A_NRT    ap_score=0.3
    Generate Test Variables And Data For Agency Preferences    ap_carrier_code=AB    ap_iss_country=C_PH    ap_origin=A_MNL    ap_destination=A_NRT    ap_score=0.4
    Generate Test Variables And Data For Agency Preferences    ap_carrier_code=AC    ap_iss_country=C_PH    ap_origin=A_MNL    ap_destination=A_NRT    ap_score=0.5
    # Different AP Origin And Destination
    Generate Test Variables And Data For Agency Preferences    ap_carrier_code=BA    ap_iss_country=C_PH    ap_origin=A_LHR    ap_destination=A_JFK    ap_score=0.6
    # Different AP Issuing Country
    Generate Test Variables And Data For Agency Preferences    ap_carrier_code=CA    ap_iss_country=C_JP    ap_origin=A_MNL    ap_destination=A_NRT    ap_score=0.7
    # Multiple Matching CP Data
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=B:4567    cp_carrier_code=AA    cp_origin=A_MNL    cp_destination=A_NRT    cp_score=0.8    cp_policy_order=1
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=B:4567    cp_carrier_code=AD    cp_origin=A_MNL    cp_destination=A_NRT    cp_score=0.9    cp_policy_order=2
    # Different CP CSU GUID
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=C:8910    cp_carrier_code=BA    cp_origin=A_MNL    cp_destination=A_NRT    cp_score=0.1
    # Different CP Origin And Destination
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=B:4567    cp_carrier_code=DA    cp_origin=A_LHR    cp_destination=A_JFK    cp_score=0.3
    # Single Matching Boost Data
    Generate Test Variables And Data For Boost    boost_app_id=Desktop_Amadeus    boost_ap=0.7    boost_cp=1
    # Different Boost Consumer
    Comment    Generate Test Variables And Data For Boost    boost_app_id=MyCWT_Mobile    boost_ap=0.1    boost_cp=0.9
    Send GET request
    Verify That Correct Status Code Are Returned    200
    Verify That Response Headers Are Correct
    Comment    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"DATASET_${prefix}","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.7,"cpScore":1.0,"totalScore":1.7},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.7,"cpScore":0.0,"totalScore":0.7},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.7,"cpScore":0.0,"totalScore":0.7},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6666667,"totalScore":0.6666667}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"consumer":"Desktop_Amadeus","tpBoost":0.5,"cpBoost":1.0,"apBoost":0.7,"others":{"Factor1":"test"}},"meta":${tp_meta_data}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.2,"cpScore":1.0,"totalScore":1.2},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.2,"cpScore":0.0,"totalScore":0.2},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.2,"cpScore":0.0,"totalScore":0.2},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6666667,"totalScore":0.6666667}]}}}
    Comment    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"DATASET_${prefix}","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.7,"cpScore":1.0,"totalScore":1.7},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.7,"cpScore":0.0,"totalScore":0.7},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.7,"cpScore":0.0,"totalScore":0.7},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6666667,"totalScore":0.6666667}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"tpBoost":0.5,"cpBoost":1.0,"apBoost":0.7,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.2,"cpScore":1.0,"totalScore":1.2},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.2,"cpScore":0.0,"totalScore":0.2},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.2,"cpScore":0.0,"totalScore":0.2},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6666667,"totalScore":0.6666667}]}}}
    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"${prefix}","offlineAlgorithm": "${offline_algorithm}","onlineAlgorithm": "${online_algorithm}","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.7,"cpScore":1,"totalScore":1.7},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.7,"cpScore":0.0,"totalScore":0.7},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.7,"cpScore":0.0,"totalScore":0.7},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":2,"cpDerivedPolicyOrder":2,"apScore":0,"cpScore":0.6666667,"totalScore":0.6666667}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"tpBoost":0.5,"cpBoost":1,"apBoost":0.7,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.2,"cpScore":1,"totalScore":1.2},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.2,"cpScore":0.0,"totalScore":0.2},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.2,"cpScore":0.0,"totalScore":0.2},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":2,"cpDerivedPolicyOrder":2,"apScore":0.0,"cpScore":0.6666667,"totalScore":0.6666667}]}}}

FNC_003 Score Is Succesfully Retrieved With Multiple Matching When Hierarchy Is On Country (Same Hierarchy)
    Delete All Versions Redis Keys
    Generate Test Data For Traveler Preference 2    V1,S:0986
    Generate Test Variables For Get Personalization Admin Score    tp_boost=0.7    ap_boost=0.8    cp_boost=0.9    csu_guid=E:8910    iss_country=US    origin=JFK
    ...    destination=LHR    dep_date=20181216    app_id=MyCWT_Mobile
    Create TP Meta Data
    Create Test Data For Metadata
    # Multiple Matching Data
    Generate Test Variables And Data For Agency Preferences    ap_carrier_code=AA    ap_origin=C_US    ap_destination=C_GB    ap_score=0.1
    Generate Test Variables And Data For Agency Preferences    ap_carrier_code=AB    ap_origin=C_US    ap_destination=C_GB    ap_score=0.2
    Generate Test Variables And Data For Agency Preferences    ap_carrier_code=AC    ap_origin=C_US    ap_destination=C_GB    ap_score=0.3
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=E:8910    cp_carrier_code=AA    cp_origin=C_US    cp_destination=C_GB    cp_score=0.4    cp_policy_order=1
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=E:8910    cp_carrier_code=AD    cp_origin=C_US    cp_destination=C_GB    cp_score=0.5    cp_policy_order=2
    Generate Test Variables And Data For Boost    boost_app_id=MyCWT_Mobile    boost_ap=0.6    boost_cp=0.7
    Send GET request
    Verify That Correct Status Code Are Returned    200
    Verify That Response Headers Are Correct
    Comment    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"DATASET_${prefix}","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.6,"cpScore":0.7,"totalScore":1.3},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.6,"cpScore":0.0,"totalScore":0.6},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.6,"cpScore":0.0,"totalScore":0.6},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.46666667,"totalScore":0.46666667}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"consumer":"MyCWT_Mobile","tpBoost":0.5,"cpBoost":0.7,"apBoost":0.6,"others":{"Factor1":"test"}},"meta":${tp_meta_data}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.8,"cpScore":0.9,"totalScore":1.7},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.8,"cpScore":0.0,"totalScore":0.8},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.8,"cpScore":0.0,"totalScore":0.8},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6}]}}}
    Comment    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"DATASET_${prefix}","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.6,"cpScore":0.7,"totalScore":1.3},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.6,"cpScore":0.0,"totalScore":0.6},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.6,"cpScore":0.0,"totalScore":0.6},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.46666667,"totalScore":0.46666667}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"tpBoost":0.5,"cpBoost":0.7,"apBoost":0.6,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.8,"cpScore":0.9,"totalScore":1.7},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.8,"cpScore":0.0,"totalScore":0.8},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.8,"cpScore":0.0,"totalScore":0.8},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6}]}}}
    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"${prefix}","offlineAlgorithm": "${offline_algorithm}","onlineAlgorithm": "${online_algorithm}","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.6,"cpScore":0.7,"totalScore":1.3},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.6,"cpScore":0.0,"totalScore":0.6},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.6,"cpScore":0.0,"totalScore":0.6},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":2,"cpDerivedPolicyOrder":2,"apScore":0.0,"cpScore":0.46666667,"totalScore":0.46666667}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"tpBoost":0.5,"cpBoost":0.7,"apBoost":0.6,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.8,"cpScore":0.9,"totalScore":1.7},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.8,"cpScore":0.0,"totalScore":0.8},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.8,"cpScore":0.0,"totalScore":0.8},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":2,"cpDerivedPolicyOrder":2,"apScore":0.0,"cpScore":0.6,"totalScore":0.6}]}}}

FNC_004 Score Is Succesfully Retrieved With Multiple Data With Multiple Matching When Hierarchy Is On Global Sub Region (Different Hierarchy)
    Delete All Versions Redis Keys
    Generate Test Data For Traveler Preference 2    V1,S:0986
    Generate Test Variables For Get Personalization Admin Score    tp_boost=0.1    ap_boost=0.2    cp_boost=0.3    csu_guid=E:8910    iss_country=JP    origin=NRT
    ...    destination=MNL    dep_date=20181217    app_id=Desktop_Amadeus
    Create TP Meta Data
    Create Test Data For Metadata    app_id=Desktop_Amadeus
    # Multiple Matching Data
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=E:8910    cp_carrier_code=AA    cp_origin=A_NRT    cp_destination=SR_PACIF
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=E:8910    cp_carrier_code=AB    cp_origin=A_NRT    cp_destination=SR_PACIF
    Generate Test Variables And Data For Boost    boost_app_id=Desktop_Amadeus    boost_ap=0.3    boost_cp=0.4
    # Multiple Non Matching Data
    Comment    Generate Test Variables And Data For Boost    boost_app_id=MyCWT_Mobile    boost_ap=0.7    boost_cp=0.8
    Send GET request
    Verify That Correct Status Code Are Returned    200
    Verify That Response Headers Are Correct
    Comment    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"DATASET_${prefix}","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"consumer":"Desktop_Amadeus","tpBoost":0.5,"cpBoost":0.4,"apBoost":0.3,"others":{"Factor1":"test"}},"meta":${tp_meta_data}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.3,"totalScore":0.3},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.3,"totalScore":0.3}]}}}
    Comment    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"DATASET_${prefix}","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"tpBoost":0.5,"cpBoost":0.4,"apBoost":0.3,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.3,"totalScore":0.3},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.3,"totalScore":0.3}]}}}
    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"${prefix}","offlineAlgorithm": "${offline_algorithm}","onlineAlgorithm": "${online_algorithm}","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.4,"totalScore":0.4}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"tpBoost":0.5,"cpBoost":0.4,"apBoost":0.3,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.3,"totalScore":0.3},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.3,"totalScore":0.3}]}}}

FNC_005 Score Is Succesfully Retrieved With Multiple Matching Where Origin-Destination Code Type Is City (City Code Match)
    Delete All Versions Redis Keys
    Generate Test Data For Traveler Preference 2    V1,S:0986
    Generate Test Variables For Get Personalization Admin Score    tp_boost=0.4    ap_boost=0.5    cp_boost=0.6    csu_guid=C:1234    iss_country=US    origin=TYO
    ...    destination=SFY    dep_date=20181212    app_id=MyCWT_Mobile    origin_code_type=C    destination_code_type=C
    Create TP Meta Data
    Create Test Data For Metadata    app_id=MyCWT_Mobile
    # CP Data Using City Code
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=C:1234    cp_carrier_code=AA    cp_origin=CI_TYO    cp_destination=CI_SFY    cp_score=0.2
    # Single Matching Boost Data
    Generate Test Variables And Data For Boost    boost_app_id=MyCWT_Mobile    boost_ap=0.7    boost_cp=0.4
    Send GET request
    Verify That Correct Status Code Are Returned    200
    Verify That Response Headers Are Correct
    Comment    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"DATASET_${prefix}","result":{"score":[{"carrierCode":"AA","cabinType":"BUS","origin":"OKO","destination":"ZSF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"NRT","destination":"ZSF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"HND","destination":"CEF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"NRT","destination":"CEF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"HND","destination":"ZSF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"OKO","destination":"CEF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"consumer":"MyCWT_Mobile","tpBoost":0.5,"cpBoost":0.4,"apBoost":0.7,"others":{"Factor1":"test"}},"meta":${tp_meta_data}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"BUS","origin":"OKO","destination":"ZSF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"NRT","destination":"ZSF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"HND","destination":"CEF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"NRT","destination":"CEF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"HND","destination":"ZSF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"OKO","destination":"CEF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6}]}}}
    Comment    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"DATASET_${prefix}","result":{"score":[{"carrierCode":"AA","cabinType":"BUS","origin":"OKO","destination":"ZSF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"NRT","destination":"ZSF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"HND","destination":"CEF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"NRT","destination":"CEF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"HND","destination":"ZSF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"OKO","destination":"CEF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"tpBoost":0.5,"cpBoost":0.4,"apBoost":0.7,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"BUS","origin":"OKO","destination":"ZSF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"NRT","destination":"ZSF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"HND","destination":"CEF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"NRT","destination":"CEF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"HND","destination":"ZSF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"OKO","destination":"CEF","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6}]}}}
    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"${prefix}","offlineAlgorithm": "${offline_algorithm}","onlineAlgorithm": "${online_algorithm}","result":{"score":[{"carrierCode":"AA","cabinType":"BUS","origin":"OKO","destination":"ZSF","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"NRT","destination":"ZSF","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"HND","destination":"CEF","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"NRT","destination":"CEF","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"HND","destination":"ZSF","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"AA","cabinType":"BUS","origin":"OKO","destination":"CEF","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.4,"totalScore":0.4}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"tpBoost":0.5,"cpBoost":0.4,"apBoost":0.7,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"BUS","origin":"OKO","destination":"ZSF","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"NRT","destination":"ZSF","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"HND","destination":"CEF","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"NRT","destination":"CEF","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"HND","destination":"ZSF","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AA","cabinType":"BUS","origin":"OKO","destination":"CEF","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.6,"totalScore":0.6}]}}}

FNC_006 Score Is Succesfully Retrieved With Multiple Matching With AP (Outbound, Lower Boundary) , CP (Inbound, Upper Boundary) For Departure Date
    Delete All Versions Redis Keys
    Generate Test Data For Traveler Preference 2    V1,S:0986
    Generate Test Variables For Get Personalization Admin Score    tp_boost=0.7    ap_boost=0.8    cp_boost=0.9    dep_date=20181208
    Create TP Meta Data
    Create Test Data For Metadata    app_id=MyCWT_Mobile
    # OutBound AP Dep Date
    Generate Test Variables And Data For Agency Preferences    ap_carrier_code=AK    ap_valid_from=20181209    ap_valid_to=20181212    ap_score=0.1
    #Boundry AP Dep Date Valid From
    Generate Test Variables And Data For Agency Preferences    ap_carrier_code=AN    ap_valid_from=20181208    ap_valid_to=20181210    ap_score=0.2
    #InBound CP Dep Date
    Generate Test Variables And Data For Client Preferences    cp_carrier_code=AK    cp_valid_from=20181206    cp_valid_to=20181212    cp_policy_order=2
    # Boundry CP Dep Date Valid TO
    Generate Test Variables And Data For Client Preferences    cp_carrier_code=AN    cp_valid_from=20181204    cp_valid_to=20181208    cp_policy_order=1
    Generate Test Variables And Data For Boost    boost_app_id=MyCWT_Mobile    boost_ap=0.1    boost_cp=1
    Send GET request
    Verify That Correct Status Code Are Returned    200
    Verify That Response Headers Are Correct
    Comment    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"DATASET_${prefix}","result":{"score":[{"carrierCode":"AK","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6666667,"totalScore":0.6666667},{"carrierCode":"AN","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.1,"cpScore":1.0,"totalScore":1.1}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"consumer":"MyCWT_Mobile","tpBoost":0.5,"cpBoost":1.0,"apBoost":0.1,"others":{"Factor1":"test"}},"meta":${tp_meta_data}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AK","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AN","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.8,"cpScore":0.9,"totalScore":1.7}]}}}
    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"${prefix}","offlineAlgorithm": "${offline_algorithm}","onlineAlgorithm": "${online_algorithm}","result":{"score":[{"carrierCode":"AK","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":2,"cpDerivedPolicyOrder":2,"apScore":0.0,"cpScore":0.6666667,"totalScore":0.6666667},{"carrierCode":"AN","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.1,"cpScore":1,"totalScore":1.1}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"tpBoost":0.5,"cpBoost":1.0,"apBoost":0.1,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AK","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":2,"cpDerivedPolicyOrder":2,"apScore":0.0,"cpScore":0.6,"totalScore":0.6},{"carrierCode":"AN","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.8,"cpScore":0.9,"totalScore":1.7}]}}}

FNC_007 Score Is Succesfully Retrieved With No AP, CP Data
    Delete All Versions Redis Keys
    Generate Test Data For Traveler Preference 2    V1,S:0986
    Create TP Meta Data
    Create Test Data For Metadata
    Generate Test Variables For Get Personalization Admin Score
    Generate Test Variables And Data For Boost    boost_ap=0.3    boost_cp=0.7
    Send GET request
    Verify That Correct Status Code Are Returned    200
    Verify That Response Headers Are Correct
    Comment    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"DATASET_${prefix}","result":{"score":[],"travelerPreference":${${trv_guid}_trv_data},"boost":{"consumer":"MyCWT_Mobile","tpBoost":0.5,"cpBoost":0.7,"apBoost":0.3,"others":{"Factor1":"test"}},"meta":${tp_meta_data}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[]}}}
    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"${prefix}","offlineAlgorithm": "${offline_algorithm}","onlineAlgorithm": "${online_algorithm}","result":{"score":[],"travelerPreference":${${trv_guid}_trv_data},"boost":{"tpBoost":0.5,"cpBoost":0.7,"apBoost":0.3,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[]}}}

FNC_010 Response Contains The Same Transaction ID Supplied In The Request
    Delete All Versions Redis Keys
    Generate Test Data For Traveler Preference 2    V1,S:0986
    Generate Test Variables For Get Personalization Admin Score    txn_id=ABCD12345
    Create TP Meta Data
    Create Test Data For Metadata
    Generate Test Variables And Data For Boost
    Send GET request
    Verify That Correct Status Code Are Returned    200
    Verify That Response Headers Are Correct

FNC_011 Response Contains A System Generated Transaction ID When Not Supplied In The Request
    Delete All Versions Redis Keys
    Generate Test Data For Traveler Preference 2    V1,S:0986
    Generate Test Variables For Get Personalization Admin Score    txn_id=None
    Create TP Meta Data
    Create Test Data For Metadata
    Generate Test Variables And Data For Boost
    Send GET request
    Verify That Correct Status Code Are Returned    200
    Verify That Response Headers Are Correct

FNC_012 Score Is Successfully Retrieved When useDataSet Is Not Available and Dataset Config Is Available Matching With ClientId
    Delete All Versions Redis Keys
    Generate Test Variables For Get Personalization Admin Score    prefix=None    csu_guid=B:4567    tp_boost=0.4    ap_boost=0.5    cp_boost=0.6
    Generate Test Data For Traveler Preference 2    V1,S:0986
    Create TP Meta Data
    Create Test Data For Metadata    group=A
    Comment    Generate Test Data For Dataset Config    B:4567,DATASET_B
    # Single Matching AP, CP and Boost Data
    Generate Test Variables And Data For Agency Preferences    ap_version=V1    ap_carrier_code=CE    ap_score=0.2
    Generate Test Variables And Data For Client Preferences    cp_version=V1    cp_carrier_code=CE    cp_score=0.8
    Generate Test Variables And Data For Boost    boost_tp=0.4    boost_ap=0.2    boost_cp=0.8
    # Non-Matching AP, CP and Boost Data
    Generate Test Variables And Data For Agency Preferences    ap_version=V2    ap_carrier_code=CD    ap_score=0.1
    Generate Test Variables And Data For Client Preferences    cp_version=V2    cp_carrier_code=CD    cp_score=0.9
    Generate Test Variables And Data For Boost    boost_version=v3    boost_tp=0.5    boost_ap=0.4    boost_cp=0.5
    Send GET Request
    Verify That Correct Status Code Are Returned    200
    Verify That Response Headers Are Correct
    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"A","offlineAlgorithm": "${offline_algorithm}","onlineAlgorithm": "${online_algorithm}","result":{"score":[{"carrierCode":"CE","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.2,"cpScore":0.8,"totalScore":1.0}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"tpBoost":0.4,"cpBoost":0.8,"apBoost":0.2,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"CE","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.5,"cpScore":0.6,"totalScore":1.1}]}}}

FNC_013 Score Is Successfully Retrieved With AP And CP Data With Dynamic Score
    [Setup]    Delete All Redis Keys Using Pattern    A::*
    Delete All Versions Redis Keys
    Generate Test Data For Traveler Preference 2    V1,S:0986
    Generate Test Variables For Get Personalization Admin Score    csu_guid=A:1234    iss_country=GB    origin=JFK    destination=LHR    ap_boost=0.6    cp_boost=0.4
    Create TP Meta Data
    Create Test Data For Metadata
    # Multiple Matching AP Data With Origin Airport
    Generate Test Variables And Data For Agency Preferences    row_id=1    ap_carrier_code=AA    ap_iss_country=C_GB    ap_origin=A_JFK    ap_destination=A_LHR    ap_score=0.1
    ...    ap_policy_order=2
    Generate Test Variables And Data For Agency Preferences    row_id=1    ap_carrier_code=AB    ap_iss_country=C_GB    ap_origin=A_JFK    ap_destination=C_GB    ap_score=0.2
    ...    ap_policy_order=2
    Generate Test Variables And Data For Agency Preferences    row_id=1    ap_carrier_code=AC    ap_iss_country=C_GB    ap_origin=A_JFK    ap_destination=R_EUR    ap_score=0.3
    ...    ap_policy_order=2
    Generate Test Variables And Data For Agency Preferences    row_id=1    ap_carrier_code=AD    ap_iss_country=C_GB    ap_origin=A_JFK    ap_destination=G_YYYY    ap_score=0.4
    ...    ap_policy_order=2
    # Multiple Matching AP Data With Origin Country
    Generate Test Variables And Data For Agency Preferences    row_id=2    ap_carrier_code=AE    ap_iss_country=C_GB    ap_origin=C_US    ap_destination=A_LHR    ap_score=0.5
    ...    ap_policy_order=3
    Generate Test Variables And Data For Agency Preferences    row_id=2    ap_carrier_code=AF    ap_iss_country=C_GB    ap_origin=C_US    ap_destination=C_GB    ap_score=0.6
    ...    ap_policy_order=3
    Generate Test Variables And Data For Agency Preferences    row_id=2    ap_carrier_code=AG    ap_iss_country=C_GB    ap_origin=C_US    ap_destination=R_EUR    ap_score=0.7
    ...    ap_policy_order=3
    Generate Test Variables And Data For Agency Preferences    row_id=2    ap_carrier_code=AH    ap_iss_country=C_GB    ap_origin=C_US    ap_destination=G_YYYY    ap_score=0.8
    ...    ap_policy_order=3
    # Multiple Matching AP Data With Origin Region
    Generate Test Variables And Data For Agency Preferences    row_id=3    ap_carrier_code=AI    ap_iss_country=C_GB    ap_origin=R_NAM    ap_destination=A_LHR    ap_score=0.9
    ...    ap_policy_order=4
    Generate Test Variables And Data For Agency Preferences    row_id=3    ap_carrier_code=AJ    ap_iss_country=C_GB    ap_origin=R_NAM    ap_destination=C_GB    ap_score=1.10
    ...    ap_policy_order=4
    Generate Test Variables And Data For Agency Preferences    row_id=3    ap_carrier_code=AK    ap_iss_country=C_GB    ap_origin=R_NAM    ap_destination=R_EUR    ap_score=1.20
    ...    ap_policy_order=4
    Generate Test Variables And Data For Agency Preferences    row_id=3    ap_carrier_code=AL    ap_iss_country=C_GB    ap_origin=R_NAM    ap_destination=G_YYYY    ap_score=1.30
    ...    ap_policy_order=4
    # Multiple Matching AP Data With Origin Global
    Generate Test Variables And Data For Agency Preferences    row_id=4    ap_carrier_code=AM    ap_iss_country=C_GB    ap_origin=G_YYYY    ap_destination=A_LHR    ap_score=1.40
    ...    ap_policy_order=5
    Generate Test Variables And Data For Agency Preferences    row_id=4    ap_carrier_code=AN    ap_iss_country=C_GB    ap_origin=G_YYYY    ap_destination=C_GB    ap_score=1.50
    ...    ap_policy_order=5
    Generate Test Variables And Data For Agency Preferences    row_id=4    ap_carrier_code=AO    ap_iss_country=C_GB    ap_origin=G_YYYY    ap_destination=R_EUR    ap_score=1.60
    ...    ap_policy_order=5
    Generate Test Variables And Data For Agency Preferences    row_id=4    ap_carrier_code=AP    ap_iss_country=C_GB    ap_origin=G_YYYY    ap_destination=G_YYYY    ap_score=1.70
    ...    ap_policy_order=5
    # Multiple Matching AP Data With Origin Airport And POS Region
    Generate Test Variables And Data For Agency Preferences    row_id=5    ap_carrier_code=AQ    ap_iss_country=R_EUR    ap_origin=A_JFK    ap_destination=A_LHR    ap_score=1.80
    ...    ap_policy_order=6
    Generate Test Variables And Data For Agency Preferences    row_id=5    ap_carrier_code=AR    ap_iss_country=R_EUR    ap_origin=A_JFK    ap_destination=C_GB    ap_score=1.90
    ...    ap_policy_order=6
    Generate Test Variables And Data For Agency Preferences    row_id=5    ap_carrier_code=AS    ap_iss_country=R_EUR    ap_origin=A_JFK    ap_destination=R_EUR    ap_score=2.00
    ...    ap_policy_order=6
    Generate Test Variables And Data For Agency Preferences    row_id=5    ap_carrier_code=AT    ap_iss_country=R_EUR    ap_origin=A_JFK    ap_destination=G_YYYY    ap_score=2.10
    ...    ap_policy_order=6
    # Multiple Matching AP Data With Origin Country And POS Region
    Generate Test Variables And Data For Agency Preferences    row_id=6    ap_carrier_code=AU    ap_iss_country=R_EUR    ap_origin=C_US    ap_destination=A_LHR    ap_score=2.20
    ...    ap_policy_order=7
    Generate Test Variables And Data For Agency Preferences    row_id=6    ap_carrier_code=AV    ap_iss_country=R_EUR    ap_origin=C_US    ap_destination=C_GB    ap_score=2.30
    ...    ap_policy_order=7
    Generate Test Variables And Data For Agency Preferences    row_id=6    ap_carrier_code=AW    ap_iss_country=R_EUR    ap_origin=C_US    ap_destination=R_EUR    ap_score=2.40
    ...    ap_policy_order=7
    Generate Test Variables And Data For Agency Preferences    row_id=6    ap_carrier_code=AX    ap_iss_country=R_EUR    ap_origin=C_US    ap_destination=G_YYYY    ap_score=2.50
    ...    ap_policy_order=7
    # Multiple Matching AP Data With Origin Region And POS Region
    Generate Test Variables And Data For Agency Preferences    row_id=7    ap_carrier_code=AY    ap_iss_country=R_EUR    ap_origin=R_NAM    ap_destination=A_LHR    ap_score=2.60
    ...    ap_policy_order=8
    Generate Test Variables And Data For Agency Preferences    row_id=7    ap_carrier_code=AZ    ap_iss_country=R_EUR    ap_origin=R_NAM    ap_destination=C_GB    ap_score=2.70
    ...    ap_policy_order=8
    Generate Test Variables And Data For Agency Preferences    row_id=7    ap_carrier_code=A1    ap_iss_country=R_EUR    ap_origin=R_NAM    ap_destination=R_EUR    ap_score=2.80
    ...    ap_policy_order=8
    Generate Test Variables And Data For Agency Preferences    row_id=7    ap_carrier_code=A2    ap_iss_country=R_EUR    ap_origin=R_NAM    ap_destination=G_YYYY    ap_score=2.90
    ...    ap_policy_order=8
    # Multiple Matching AP Data With Origin Global And POS Region
    Generate Test Variables And Data For Agency Preferences    row_id=8    ap_carrier_code=A3    ap_iss_country=R_EUR    ap_origin=G_YYYY    ap_destination=A_LHR    ap_score=3.00
    ...    ap_policy_order=9
    Generate Test Variables And Data For Agency Preferences    row_id=8    ap_carrier_code=A4    ap_iss_country=R_EUR    ap_origin=G_YYYY    ap_destination=C_GB    ap_score=3.10
    ...    ap_policy_order=9
    Generate Test Variables And Data For Agency Preferences    row_id=8    ap_carrier_code=A5    ap_iss_country=R_EUR    ap_origin=G_YYYY    ap_destination=R_EUR    ap_score=3.20
    ...    ap_policy_order=9
    Generate Test Variables And Data For Agency Preferences    row_id=8    ap_carrier_code=A6    ap_iss_country=R_EUR    ap_origin=G_YYYY    ap_destination=G_YYYY    ap_score=3.30
    ...    ap_policy_order=9
    # Multiple Matching CP Data
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AA    cp_origin=A_JFK    cp_destination=A_LHR    cp_policy_order=1
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AB    cp_origin=A_JFK    cp_destination=CI_LON    cp_policy_order=2
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AC    cp_origin=CI_NYC    cp_destination=A_LHR    cp_policy_order=3
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AD    cp_origin=A_JFK    cp_destination=C_GB    cp_policy_order=4
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AE    cp_origin=C_US    cp_destination=A_LHR    cp_policy_order=5
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AF    cp_origin=A_JFK    cp_destination=SR_EUROP    cp_policy_order=6
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AG    cp_origin=SR_NAMER    cp_destination=A_LHR    cp_policy_order=7
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AH    cp_origin=A_JFK    cp_destination=R_EMEA    cp_policy_order=8
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AI    cp_origin=R_NORAM    cp_destination=A_LHR    cp_policy_order=9
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AJ    cp_origin=A_JFK    cp_destination=G_YYYY    cp_policy_order=10
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AK    cp_origin=G_YYYY    cp_destination=A_LHR    cp_policy_order=11
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AL    cp_origin=CI_NYC    cp_destination=CI_LON    cp_policy_order=12
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AM    cp_origin=CI_NYC    cp_destination=C_GB    cp_policy_order=13
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AN    cp_origin=C_US    cp_destination=CI_LON    cp_policy_order=14
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AO    cp_origin=CI_NYC    cp_destination=SR_EUROP    cp_policy_order=15
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AP    cp_origin=SR_NAMER    cp_destination=CI_LON    cp_policy_order=16
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AQ    cp_origin=CI_NYC    cp_destination=R_EMEA    cp_policy_order=17
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AR    cp_origin=R_NORAM    cp_destination=CI_LON    cp_policy_order=18
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AS    cp_origin=CI_NYC    cp_destination=G_YYYY    cp_policy_order=19
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AT    cp_origin=G_YYYY    cp_destination=CI_LON    cp_policy_order=20
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AU    cp_origin=C_US    cp_destination=C_GB    cp_policy_order=21
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AV    cp_origin=C_US    cp_destination=SR_EUROP    cp_policy_order=22
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AW    cp_origin=SR_NAMER    cp_destination=C_GB    cp_policy_order=23
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AX    cp_origin=C_US    cp_destination=R_EMEA    cp_policy_order=24
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AY    cp_origin=R_NORAM    cp_destination=C_GB    cp_policy_order=25
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AZ    cp_origin=C_US    cp_destination=G_YYYY    cp_policy_order=26
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A0    cp_origin=G_YYYY    cp_destination=C_GB    cp_policy_order=27
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A1    cp_origin=SR_NAMER    cp_destination=SR_EUROP    cp_policy_order=28
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A2    cp_origin=SR_NAMER    cp_destination=R_EMEA    cp_policy_order=29
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A3    cp_origin=R_NORAM    cp_destination=SR_EUROP    cp_policy_order=30
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A4    cp_origin=SR_NAMER    cp_destination=G_YYYY    cp_policy_order=31
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A5    cp_origin=G_YYYY    cp_destination=SR_EUROP    cp_policy_order=32
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A6    cp_origin=R_NORAM    cp_destination=R_EMEA    cp_policy_order=33
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A7    cp_origin=R_NORAM    cp_destination=G_YYYY    cp_policy_order=34
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A8    cp_origin=G_YYYY    cp_destination=R_EMEA    cp_policy_order=35
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A9    cp_origin=G_YYYY    cp_destination=G_YYYY    cp_policy_order=36
    #Matching Boost Data
    Generate Test Variables And Data For Boost    boost_ap=0.3    boost_cp=0.3
    Send GET request
    Comment    Calculate And Compare Dynamic Scores    8    0.3    apScore
    Comment    Calculate And Compare Dynamic Scores    36    0.3    cpScore
    Verify That Correct Status Code Are Returned    200
    Verify That Response Headers Are Correct
    Comment    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"DATASET_${prefix}","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.3,"cpScore":0.3,"totalScore":0.6},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.3,"cpScore":0.2918919,"totalScore":0.5918919},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.3,"cpScore":0.2837838,"totalScore":0.5837838},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.3,"cpScore":0.27567568,"totalScore":0.5756757},{"carrierCode":"AE","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.26666668,"cpScore":0.26756757,"totalScore":0.5342343},{"carrierCode":"AF","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.26666668,"cpScore":0.25945947,"totalScore":0.52612615},{"carrierCode":"AG","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.26666668,"cpScore":0.25135136,"totalScore":0.518018},{"carrierCode":"AH","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.26666668,"cpScore":0.24324325,"totalScore":0.5099099},{"carrierCode":"AI","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.23333335,"cpScore":0.23513515,"totalScore":0.4684685},{"carrierCode":"AJ","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.23333335,"cpScore":0.22702704,"totalScore":0.4603604},{"carrierCode":"AK","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.23333335,"cpScore":0.21891892,"totalScore":0.45225227},{"carrierCode":"AL","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.23333335,"cpScore":0.21081083,"totalScore":0.4441442},{"carrierCode":"AM","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.20000002,"cpScore":0.20270272,"totalScore":0.40270275},{"carrierCode":"AN","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.20000002,"cpScore":0.19459459,"totalScore":0.3945946},{"carrierCode":"AO","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.20000002,"cpScore":0.18648648,"totalScore":0.3864865},{"carrierCode":"AP","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.20000002,"cpScore":0.17837839,"totalScore":0.3783784},{"carrierCode":"AQ","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.16666669,"cpScore":0.17027028,"totalScore":0.33693695},{"carrierCode":"AR","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.16666669,"cpScore":0.16216215,"totalScore":0.32882884},{"carrierCode":"AS","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.16666669,"cpScore":0.15405406,"totalScore":0.32072073},{"carrierCode":"AT","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.16666669,"cpScore":0.14594595,"totalScore":0.31261265},{"carrierCode":"AU","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.13333334,"cpScore":0.13783784,"totalScore":0.27117118},{"carrierCode":"AV","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.13333334,"cpScore":0.12972973,"totalScore":0.26306307},{"carrierCode":"AW","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.13333334,"cpScore":0.12162162,"totalScore":0.25495496},{"carrierCode":"AX","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.13333334,"cpScore":0.11351352,"totalScore":0.24684685},{"carrierCode":"AY","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.10000001,"cpScore":0.10540541,"totalScore":0.20540541},{"carrierCode":"AZ","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.10000001,"cpScore":0.097297296,"totalScore":0.1972973},{"carrierCode":"A0","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.089189194,"totalScore":0.089189194},{"carrierCode":"A1","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.10000001,"cpScore":0.08108108,"totalScore":0.18108109},{"carrierCode":"A2","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.10000001,"cpScore":0.072972976,"totalScore":0.17297298},{"carrierCode":"A3","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.06666667,"cpScore":0.06486487,"totalScore":0.13153154},{"carrierCode":"A4","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.06666667,"cpScore":0.05675676,"totalScore":0.12342343},{"carrierCode":"A5","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.06666667,"cpScore":0.048648648,"totalScore":0.11531532},{"carrierCode":"A6","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.06666667,"cpScore":0.04054054,"totalScore":0.10720721},{"carrierCode":"A7","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.032432433,"totalScore":0.032432433},{"carrierCode":"A8","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.024324324,"totalScore":0.024324324},{"carrierCode":"A9","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.016216217,"totalScore":0.016216217}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"tpBoost":0.5,"cpBoost":0.3,"apBoost":0.3,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.6,"cpScore":0.4,"totalScore":1.0},{"carrierCode":"AB","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.6,"cpScore":0.3891892,"totalScore":0.98918927},{"carrierCode":"AC","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.6,"cpScore":0.37837836,"totalScore":0.9783784},{"carrierCode":"AD","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.6,"cpScore":0.36756757,"totalScore":0.96756756},{"carrierCode":"AQ","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.33333337,"cpScore":0.22702704,"totalScore":0.56036043},{"carrierCode":"AR","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.33333337,"cpScore":0.2162162,"totalScore":0.5495496},{"carrierCode":"AS","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.33333337,"cpScore":0.2054054,"totalScore":0.5387388},{"carrierCode":"AT","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.33333337,"cpScore":0.1945946,"totalScore":0.527928},{"carrierCode":"AE","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.53333336,"cpScore":0.35675678,"totalScore":0.8900901},{"carrierCode":"AF","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.53333336,"cpScore":0.34594595,"totalScore":0.8792793},{"carrierCode":"AG","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.53333336,"cpScore":0.33513513,"totalScore":0.8684685},{"carrierCode":"AH","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.53333336,"cpScore":0.32432434,"totalScore":0.8576577},{"carrierCode":"AU","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.26666668,"cpScore":0.18378378,"totalScore":0.45045048},{"carrierCode":"AV","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.26666668,"cpScore":0.17297298,"totalScore":0.43963966},{"carrierCode":"AW","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.26666668,"cpScore":0.16216217,"totalScore":0.42882884},{"carrierCode":"AX","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.26666668,"cpScore":0.15135136,"totalScore":0.41801804},{"carrierCode":"AI","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.4666667,"cpScore":0.31351352,"totalScore":0.7801802},{"carrierCode":"AJ","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.4666667,"cpScore":0.30270272,"totalScore":0.7693694},{"carrierCode":"AK","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.4666667,"cpScore":0.2918919,"totalScore":0.75855863},{"carrierCode":"AL","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.4666667,"cpScore":0.28108108,"totalScore":0.7477478},{"carrierCode":"AY","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.20000002,"cpScore":0.14054054,"totalScore":0.34054056},{"carrierCode":"AZ","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.20000002,"cpScore":0.12972973,"totalScore":0.32972974},{"carrierCode":"A1","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.20000002,"cpScore":0.1081081,"totalScore":0.30810812},{"carrierCode":"A2","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.20000002,"cpScore":0.0972973,"totalScore":0.29729733},{"carrierCode":"AM","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.40000004,"cpScore":0.2702703,"totalScore":0.6702703},{"carrierCode":"AN","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.40000004,"cpScore":0.25945947,"totalScore":0.6594595},{"carrierCode":"AO","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.40000004,"cpScore":0.24864864,"totalScore":0.6486487},{"carrierCode":"AP","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.40000004,"cpScore":0.23783784,"totalScore":0.6378379},{"carrierCode":"A3","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.13333334,"cpScore":0.08648649,"totalScore":0.21981983},{"carrierCode":"A4","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.13333334,"cpScore":0.07567568,"totalScore":0.20900902},{"carrierCode":"A5","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.13333334,"cpScore":0.06486487,"totalScore":0.1981982},{"carrierCode":"A6","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.13333334,"cpScore":0.05405405,"totalScore":0.18738739},{"carrierCode":"A9","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.0,"cpScore":0.021621622,"totalScore":0.021621622},{"carrierCode":"A7","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.0,"cpScore":0.043243244,"totalScore":0.043243244},{"carrierCode":"A0","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.0,"cpScore":0.11891892,"totalScore":0.11891892},{"carrierCode":"A8","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.0,"cpScore":0.032432433,"totalScore":0.032432433}]}}}
    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"${prefix}","offlineAlgorithm": "${offline_algorithm}","onlineAlgorithm": "${online_algorithm}","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apPolicyOrder":2,"apDerivedPolicyOrder":1,"apScore":0.3,"cpScore":0.3,"totalScore":0.6},{"carrierCode":"AB","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":2,"cpDerivedPolicyOrder":2,"apPolicyOrder":2,"apDerivedPolicyOrder":1,"apScore":0.3,"cpScore":0.2918919,"totalScore":0.5918919},{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":3,"cpDerivedPolicyOrder":3,"apPolicyOrder":2,"apDerivedPolicyOrder":1,"apScore":0.3,"cpScore":0.2837838,"totalScore":0.5837838},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":4,"cpDerivedPolicyOrder":4,"apPolicyOrder":2,"apDerivedPolicyOrder":1,"apScore":0.3,"cpScore":0.27567568,"totalScore":0.5756757},{"carrierCode":"AE","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":5,"cpDerivedPolicyOrder":5,"apPolicyOrder":3,"apDerivedPolicyOrder":2,"apScore":0.26666668,"cpScore":0.26756757,"totalScore":0.5342343},{"carrierCode":"AF","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":6,"cpDerivedPolicyOrder":6,"apPolicyOrder":3,"apDerivedPolicyOrder":2,"apScore":0.26666668,"cpScore":0.25945947,"totalScore":0.52612615},{"carrierCode":"AG","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":7,"cpDerivedPolicyOrder":7,"apPolicyOrder":3,"apDerivedPolicyOrder":2,"apScore":0.26666668,"cpScore":0.25135136,"totalScore":0.518018},{"carrierCode":"AH","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":8,"cpDerivedPolicyOrder":8,"apPolicyOrder":3,"apDerivedPolicyOrder":2,"apScore":0.26666668,"cpScore":0.24324325,"totalScore":0.5099099},{"carrierCode":"AI","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":9,"cpDerivedPolicyOrder":9,"apPolicyOrder":4,"apDerivedPolicyOrder":3,"apScore":0.23333335,"cpScore":0.23513515,"totalScore":0.4684685},{"carrierCode":"AJ","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":10,"cpDerivedPolicyOrder":10,"apPolicyOrder":4,"apDerivedPolicyOrder":3,"apScore":0.23333335,"cpScore":0.22702704,"totalScore":0.4603604},{"carrierCode":"AK","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":11,"cpDerivedPolicyOrder":11,"apPolicyOrder":4,"apDerivedPolicyOrder":3,"apScore":0.23333335,"cpScore":0.21891892,"totalScore":0.45225227},{"carrierCode":"AL","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":12,"cpDerivedPolicyOrder":12,"apPolicyOrder":4,"apDerivedPolicyOrder":3,"apScore":0.23333335,"cpScore":0.21081083,"totalScore":0.4441442},{"carrierCode":"AM","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":13,"cpDerivedPolicyOrder":13,"apPolicyOrder":5,"apDerivedPolicyOrder":4,"apScore":0.20000002,"cpScore":0.20270272,"totalScore":0.40270275},{"carrierCode":"AN","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":14,"cpDerivedPolicyOrder":14,"apPolicyOrder":5,"apDerivedPolicyOrder":4,"apScore":0.20000002,"cpScore":0.19459459,"totalScore":0.3945946},{"carrierCode":"AO","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":15,"cpDerivedPolicyOrder":15,"apPolicyOrder":5,"apDerivedPolicyOrder":4,"apScore":0.20000002,"cpScore":0.18648648,"totalScore":0.3864865},{"carrierCode":"AP","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":16,"cpDerivedPolicyOrder":16,"apPolicyOrder":5,"apDerivedPolicyOrder":4,"apScore":0.20000002,"cpScore":0.17837839,"totalScore":0.3783784},{"carrierCode":"AQ","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":17,"cpDerivedPolicyOrder":17,"apPolicyOrder":6,"apDerivedPolicyOrder":5,"apScore":0.16666669,"cpScore":0.17027028,"totalScore":0.33693695},{"carrierCode":"AR","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":18,"cpDerivedPolicyOrder":18,"apPolicyOrder":6,"apDerivedPolicyOrder":5,"apScore":0.16666669,"cpScore":0.16216215,"totalScore":0.32882884},{"carrierCode":"AS","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":19,"cpDerivedPolicyOrder":19,"apPolicyOrder":6,"apDerivedPolicyOrder":5,"apScore":0.16666669,"cpScore":0.15405406,"totalScore":0.32072073},{"carrierCode":"AT","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":20,"cpDerivedPolicyOrder":20,"apPolicyOrder":6,"apDerivedPolicyOrder":5,"apScore":0.16666669,"cpScore":0.14594595,"totalScore":0.31261265},{"carrierCode":"AU","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":21,"cpDerivedPolicyOrder":21,"apPolicyOrder":7,"apDerivedPolicyOrder":6,"apScore":0.13333334,"cpScore":0.13783784,"totalScore":0.27117118},{"carrierCode":"AV","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":22,"cpDerivedPolicyOrder":22,"apPolicyOrder":7,"apDerivedPolicyOrder":6,"apScore":0.13333334,"cpScore":0.12972973,"totalScore":0.26306307},{"carrierCode":"AW","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":23,"cpDerivedPolicyOrder":23,"apPolicyOrder":7,"apDerivedPolicyOrder":6,"apScore":0.13333334,"cpScore":0.12162162,"totalScore":0.25495496},{"carrierCode":"AX","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":24,"cpDerivedPolicyOrder":24,"apPolicyOrder":7,"apDerivedPolicyOrder":6,"apScore":0.13333334,"cpScore":0.11351352,"totalScore":0.24684685},{"carrierCode":"AY","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":25,"cpDerivedPolicyOrder":25,"apPolicyOrder":8,"apDerivedPolicyOrder":7,"apScore":0.10000001,"cpScore":0.10540541,"totalScore":0.20540541},{"carrierCode":"AZ","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":26,"cpDerivedPolicyOrder":26,"apPolicyOrder":8,"apDerivedPolicyOrder":7,"apScore":0.10000001,"cpScore":0.097297296,"totalScore":0.1972973},{"carrierCode":"A0","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":27,"cpDerivedPolicyOrder":27,"apScore":0.0,"cpScore":0.089189194,"totalScore":0.089189194},{"carrierCode":"A1","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":28,"cpDerivedPolicyOrder":28,"apPolicyOrder":8,"apDerivedPolicyOrder":7,"apScore":0.10000001,"cpScore":0.08108108,"totalScore":0.18108109},{"carrierCode":"A2","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":29,"cpDerivedPolicyOrder":29,"apPolicyOrder":8,"apDerivedPolicyOrder":7,"apScore":0.10000001,"cpScore":0.072972976,"totalScore":0.17297298},{"carrierCode":"A3","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":30,"cpDerivedPolicyOrder":30,"apPolicyOrder":9,"apDerivedPolicyOrder":8,"apScore":0.06666667,"cpScore":0.06486487,"totalScore":0.13153154},{"carrierCode":"A4","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":31,"cpDerivedPolicyOrder":31,"apPolicyOrder":9,"apDerivedPolicyOrder":8,"apScore":0.06666667,"cpScore":0.05675676,"totalScore":0.12342343},{"carrierCode":"A5","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":32,"cpDerivedPolicyOrder":32,"apPolicyOrder":9,"apDerivedPolicyOrder":8,"apScore":0.06666667,"cpScore":0.048648648,"totalScore":0.11531532},{"carrierCode":"A6","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":33,"cpDerivedPolicyOrder":33,"apPolicyOrder":9,"apDerivedPolicyOrder":8,"apScore":0.06666667,"cpScore":0.04054054,"totalScore":0.10720721},{"carrierCode":"A7","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":34,"cpDerivedPolicyOrder":34,"apScore":0.0,"cpScore":0.032432433,"totalScore":0.032432433},{"carrierCode":"A8","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":35,"cpDerivedPolicyOrder":35,"apScore":0.0,"cpScore":0.024324324,"totalScore":0.024324324},{"carrierCode":"A9","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":36,"cpDerivedPolicyOrder":36,"apScore":0.0,"cpScore":0.016216217,"totalScore":0.016216217}],"travelerPreference":${${trv_guid}_trv_data},"boost":{"tpBoost":0.5,"cpBoost":0.3,"apBoost":0.3,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apPolicyOrder":2,"apDerivedPolicyOrder":1,"apScore":0.6,"cpScore":0.4,"totalScore":1},{"carrierCode":"AB","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":2,"cpDerivedPolicyOrder":2,"apPolicyOrder":2,"apDerivedPolicyOrder":1,"apScore":0.6,"cpScore":0.3891892,"totalScore":0.98918927},{"carrierCode":"AC","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":3,"cpDerivedPolicyOrder":3,"apPolicyOrder":2,"apDerivedPolicyOrder":1,"apScore":0.6,"cpScore":0.37837836,"totalScore":0.9783784},{"carrierCode":"AD","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":4,"cpDerivedPolicyOrder":4,"apPolicyOrder":2,"apDerivedPolicyOrder":1,"apScore":0.6,"cpScore":0.36756757,"totalScore":0.96756756},{"carrierCode":"AQ","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":17,"cpDerivedPolicyOrder":17,"apPolicyOrder":6,"apDerivedPolicyOrder":5,"apScore":0.33333337,"cpScore":0.22702704,"totalScore":0.56036043},{"carrierCode":"AR","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":18,"cpDerivedPolicyOrder":18,"apPolicyOrder":6,"apDerivedPolicyOrder":5,"apScore":0.33333337,"cpScore":0.2162162,"totalScore":0.5495496},{"carrierCode":"AS","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":19,"cpDerivedPolicyOrder":19,"apPolicyOrder":6,"apDerivedPolicyOrder":5,"apScore":0.33333337,"cpScore":0.2054054,"totalScore":0.5387388},{"carrierCode":"AT","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":20,"cpDerivedPolicyOrder":20,"apPolicyOrder":6,"apDerivedPolicyOrder":5,"apScore":0.33333337,"cpScore":0.1945946,"totalScore":0.527928},{"carrierCode":"AE","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":5,"cpDerivedPolicyOrder":5,"apPolicyOrder":3,"apDerivedPolicyOrder":2,"apScore":0.53333336,"cpScore":0.35675678,"totalScore":0.8900901},{"carrierCode":"AF","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":6,"cpDerivedPolicyOrder":6,"apPolicyOrder":3,"apDerivedPolicyOrder":2,"apScore":0.53333336,"cpScore":0.34594595,"totalScore":0.8792793},{"carrierCode":"AG","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":7,"cpDerivedPolicyOrder":7,"apPolicyOrder":3,"apDerivedPolicyOrder":2,"apScore":0.53333336,"cpScore":0.33513513,"totalScore":0.8684685},{"carrierCode":"AH","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":8,"cpDerivedPolicyOrder":8,"apPolicyOrder":3,"apDerivedPolicyOrder":2,"apScore":0.53333336,"cpScore":0.32432434,"totalScore":0.8576577},{"carrierCode":"AU","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":21,"cpDerivedPolicyOrder":21,"apPolicyOrder":7,"apDerivedPolicyOrder":6,"apScore":0.26666668,"cpScore":0.18378378,"totalScore":0.45045048},{"carrierCode":"AV","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":22,"cpDerivedPolicyOrder":22,"apPolicyOrder":7,"apDerivedPolicyOrder":6,"apScore":0.26666668,"cpScore":0.17297298,"totalScore":0.43963966},{"carrierCode":"AW","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":23,"cpDerivedPolicyOrder":23,"apPolicyOrder":7,"apDerivedPolicyOrder":6,"apScore":0.26666668,"cpScore":0.16216217,"totalScore":0.42882884},{"carrierCode":"AX","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":24,"cpDerivedPolicyOrder":24,"apPolicyOrder":7,"apDerivedPolicyOrder":6,"apScore":0.26666668,"cpScore":0.15135136,"totalScore":0.41801804},{"carrierCode":"AI","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":9,"cpDerivedPolicyOrder":9,"apPolicyOrder":4,"apDerivedPolicyOrder":3,"apScore":0.4666667,"cpScore":0.31351352,"totalScore":0.7801802},{"carrierCode":"AJ","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":10,"cpDerivedPolicyOrder":10,"apPolicyOrder":4,"apDerivedPolicyOrder":3,"apScore":0.4666667,"cpScore":0.30270272,"totalScore":0.7693694},{"carrierCode":"AK","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":11,"cpDerivedPolicyOrder":11,"apPolicyOrder":4,"apDerivedPolicyOrder":3,"apScore":0.4666667,"cpScore":0.2918919,"totalScore":0.75855863},{"carrierCode":"AL","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":12,"cpDerivedPolicyOrder":12,"apPolicyOrder":4,"apDerivedPolicyOrder":3,"apScore":0.4666667,"cpScore":0.28108108,"totalScore":0.7477478},{"carrierCode":"AY","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":25,"cpDerivedPolicyOrder":25,"apPolicyOrder":8,"apDerivedPolicyOrder":7,"apScore":0.20000002,"cpScore":0.14054054,"totalScore":0.34054056},{"carrierCode":"AZ","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":26,"cpDerivedPolicyOrder":26,"apPolicyOrder":8,"apDerivedPolicyOrder":7,"apScore":0.20000002,"cpScore":0.12972973,"totalScore":0.32972974},{"carrierCode":"A1","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":28,"cpDerivedPolicyOrder":28,"apPolicyOrder":8,"apDerivedPolicyOrder":7,"apScore":0.20000002,"cpScore":0.1081081,"totalScore":0.30810812},{"carrierCode":"A2","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":29,"cpDerivedPolicyOrder":29,"apPolicyOrder":8,"apDerivedPolicyOrder":7,"apScore":0.20000002,"cpScore":0.0972973,"totalScore":0.29729733},{"carrierCode":"AM","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":13,"cpDerivedPolicyOrder":13,"apPolicyOrder":5,"apDerivedPolicyOrder":4,"apScore":0.40000004,"cpScore":0.2702703,"totalScore":0.6702703},{"carrierCode":"AN","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":14,"cpDerivedPolicyOrder":14,"apPolicyOrder":5,"apDerivedPolicyOrder":4,"apScore":0.40000004,"cpScore":0.25945947,"totalScore":0.6594595},{"carrierCode":"AO","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":15,"cpDerivedPolicyOrder":15,"apPolicyOrder":5,"apDerivedPolicyOrder":4,"apScore":0.40000004,"cpScore":0.24864864,"totalScore":0.6486487},{"carrierCode":"AP","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":16,"cpDerivedPolicyOrder":16,"apPolicyOrder":5,"apDerivedPolicyOrder":4,"apScore":0.40000004,"cpScore":0.23783784,"totalScore":0.6378379},{"carrierCode":"A3","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":30,"cpDerivedPolicyOrder":30,"apPolicyOrder":9,"apDerivedPolicyOrder":8,"apScore":0.13333334,"cpScore":0.08648649,"totalScore":0.21981983},{"carrierCode":"A4","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":31,"cpDerivedPolicyOrder":31,"apPolicyOrder":9,"apDerivedPolicyOrder":8,"apScore":0.13333334,"cpScore":0.07567568,"totalScore":0.20900902},{"carrierCode":"A5","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":32,"cpDerivedPolicyOrder":32,"apPolicyOrder":9,"apDerivedPolicyOrder":8,"apScore":0.13333334,"cpScore":0.06486487,"totalScore":0.1981982},{"carrierCode":"A6","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":33,"cpDerivedPolicyOrder":33,"apPolicyOrder":9,"apDerivedPolicyOrder":8,"apScore":0.13333334,"cpScore":0.05405405,"totalScore":0.18738739},{"carrierCode":"A9","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":36,"cpDerivedPolicyOrder":36,"apScore":0.0,"cpScore":0.021621622,"totalScore":0.021621622},{"carrierCode":"A7","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":34,"cpDerivedPolicyOrder":34,"apScore":0.0,"cpScore":0.043243244,"totalScore":0.043243244},{"carrierCode":"A0","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":27,"cpDerivedPolicyOrder":27,"apScore":0.0,"cpScore":0.11891892,"totalScore":0.11891892},{"carrierCode":"A8","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":35,"cpDerivedPolicyOrder":35,"apScore":0.0,"cpScore":0.032432433,"totalScore":0.032432433}]}}}

FNC_077 Score Is Successfully Retrieved With OAG Data (AP, CP, TP) When applyOAGFilter Is Set To True
    Delete All Versions Redis Keys
    Generate Test Data For Client Config    ${client_config_data}
    Generate Test Data For GSM Countries Mapping    ${GSM::COUNTRIES_data}
    Generate Test Data For Features    app_id=Desktop_Amadeus    oag_value=true    cp_pass=false    default_tp=false
    Clear Cache    personalizationConfig
    Generate Test Data For Traveler Preference 2    V1,C:8901
    Generate Test Variables For Get Personalization Admin Score    trv_guid=C:8901    csu_guid=A:1234    iss_country=GB    origin=JFK    destination=LHR    dep_date=20190912
    ...    app_id=Desktop_Amadeus    tp_boost=0.7    ap_boost=0.8    cp_boost=0.9
    Create TP Meta Data
    Create Test Data For Metadata    app_id=Desktop_Amadeus
    #OAG Data Same Origin-Destination
    Generate Carriers OAG Data    CARRIERS::JFK::LHR,20191201::20190912::AA;20191201::20190712::AE;20190912::20190712::AI;20190911::20180912::AM;20191201::20190913::AQ;20191201::20190912::AU;20191201::20190912::AY;20191201::20190912::A3
    #OAG Data Different Origin-Destination
    Generate Carriers OAG Data    CARRIERS::MNL::SIN,20191201::20190912::AB;20191201::20190712::AF;20190912::20190712::AJ
    # Multiple Matching AP Data With Origin Airport
    Generate Test Variables And Data For Agency Preferences    row_id=1    ap_carrier_code=AA    ap_iss_country=C_GB    ap_origin=A_JFK    ap_destination=A_LHR    ap_score=0.1
    ...    ap_policy_order=2
    Generate Test Variables And Data For Agency Preferences    row_id=1    ap_carrier_code=AB    ap_iss_country=C_GB    ap_origin=A_JFK    ap_destination=C_GB    ap_score=0.2
    ...    ap_policy_order=2
    Generate Test Variables And Data For Agency Preferences    row_id=1    ap_carrier_code=AC    ap_iss_country=C_GB    ap_origin=A_JFK    ap_destination=R_EUR    ap_score=0.3
    ...    ap_policy_order=2
    Generate Test Variables And Data For Agency Preferences    row_id=1    ap_carrier_code=AD    ap_iss_country=C_GB    ap_origin=A_JFK    ap_destination=G_YYYY    ap_score=0.4
    ...    ap_policy_order=2
    # Multiple Matching AP Data With Origin Country
    Generate Test Variables And Data For Agency Preferences    row_id=2    ap_carrier_code=AE    ap_iss_country=C_GB    ap_origin=C_US    ap_destination=A_LHR    ap_score=0.5
    ...    ap_policy_order=3
    Generate Test Variables And Data For Agency Preferences    row_id=2    ap_carrier_code=AF    ap_iss_country=C_GB    ap_origin=C_US    ap_destination=C_GB    ap_score=0.6
    ...    ap_policy_order=3
    Generate Test Variables And Data For Agency Preferences    row_id=2    ap_carrier_code=AG    ap_iss_country=C_GB    ap_origin=C_US    ap_destination=R_EUR    ap_score=0.7
    ...    ap_policy_order=3
    Generate Test Variables And Data For Agency Preferences    row_id=2    ap_carrier_code=AH    ap_iss_country=C_GB    ap_origin=C_US    ap_destination=G_YYYY    ap_score=0.8
    ...    ap_policy_order=3
    # Multiple Matching AP Data With Origin Region
    Generate Test Variables And Data For Agency Preferences    row_id=3    ap_carrier_code=AI    ap_iss_country=C_GB    ap_origin=R_NAM    ap_destination=A_LHR    ap_score=0.9
    ...    ap_policy_order=4
    Generate Test Variables And Data For Agency Preferences    row_id=3    ap_carrier_code=AJ    ap_iss_country=C_GB    ap_origin=R_NAM    ap_destination=C_GB    ap_score=1.10
    ...    ap_policy_order=4
    Generate Test Variables And Data For Agency Preferences    row_id=3    ap_carrier_code=AK    ap_iss_country=C_GB    ap_origin=R_NAM    ap_destination=R_EUR    ap_score=1.20
    ...    ap_policy_order=4
    Generate Test Variables And Data For Agency Preferences    row_id=3    ap_carrier_code=AL    ap_iss_country=C_GB    ap_origin=R_NAM    ap_destination=G_YYYY    ap_score=1.30
    ...    ap_policy_order=4
    # Multiple Matching AP Data With Origin Global
    Generate Test Variables And Data For Agency Preferences    row_id=4    ap_carrier_code=AM    ap_iss_country=C_GB    ap_origin=G_YYYY    ap_destination=A_LHR    ap_score=1.40
    ...    ap_policy_order=5
    Generate Test Variables And Data For Agency Preferences    row_id=4    ap_carrier_code=AN    ap_iss_country=C_GB    ap_origin=G_YYYY    ap_destination=C_GB    ap_score=1.50
    ...    ap_policy_order=5
    Generate Test Variables And Data For Agency Preferences    row_id=4    ap_carrier_code=AO    ap_iss_country=C_GB    ap_origin=G_YYYY    ap_destination=R_EUR    ap_score=1.60
    ...    ap_policy_order=5
    Generate Test Variables And Data For Agency Preferences    row_id=4    ap_carrier_code=AP    ap_iss_country=C_GB    ap_origin=G_YYYY    ap_destination=G_YYYY    ap_score=1.70
    ...    ap_policy_order=5
    # Multiple Matching AP Data With Origin Airport And POS Region
    Generate Test Variables And Data For Agency Preferences    row_id=5    ap_carrier_code=AQ    ap_iss_country=R_EUR    ap_origin=A_JFK    ap_destination=A_LHR    ap_score=1.80
    ...    ap_policy_order=6
    Generate Test Variables And Data For Agency Preferences    row_id=5    ap_carrier_code=AR    ap_iss_country=R_EUR    ap_origin=A_JFK    ap_destination=C_GB    ap_score=1.90
    ...    ap_policy_order=6
    Generate Test Variables And Data For Agency Preferences    row_id=5    ap_carrier_code=AS    ap_iss_country=R_EUR    ap_origin=A_JFK    ap_destination=R_EUR    ap_score=2.00
    ...    ap_policy_order=6
    Generate Test Variables And Data For Agency Preferences    row_id=5    ap_carrier_code=AT    ap_iss_country=R_EUR    ap_origin=A_JFK    ap_destination=G_YYYY    ap_score=2.10
    ...    ap_policy_order=6
    # Multiple Matching AP Data With Origin Country And POS Region
    Generate Test Variables And Data For Agency Preferences    row_id=6    ap_carrier_code=AU    ap_iss_country=R_EUR    ap_origin=C_US    ap_destination=A_LHR    ap_score=2.20
    ...    ap_policy_order=7
    Generate Test Variables And Data For Agency Preferences    row_id=6    ap_carrier_code=AV    ap_iss_country=R_EUR    ap_origin=C_US    ap_destination=C_GB    ap_score=2.30
    ...    ap_policy_order=7
    Generate Test Variables And Data For Agency Preferences    row_id=6    ap_carrier_code=AW    ap_iss_country=R_EUR    ap_origin=C_US    ap_destination=R_EUR    ap_score=2.40
    ...    ap_policy_order=7
    Generate Test Variables And Data For Agency Preferences    row_id=6    ap_carrier_code=AX    ap_iss_country=R_EUR    ap_origin=C_US    ap_destination=G_YYYY    ap_score=2.50
    ...    ap_policy_order=7
    # Multiple Matching AP Data With Origin Region And POS Region
    Generate Test Variables And Data For Agency Preferences    row_id=7    ap_carrier_code=AY    ap_iss_country=R_EUR    ap_origin=R_NAM    ap_destination=A_LHR    ap_score=2.60
    ...    ap_policy_order=8
    Generate Test Variables And Data For Agency Preferences    row_id=7    ap_carrier_code=AZ    ap_iss_country=R_EUR    ap_origin=R_NAM    ap_destination=C_GB    ap_score=2.70
    ...    ap_policy_order=8
    Generate Test Variables And Data For Agency Preferences    row_id=7    ap_carrier_code=A1    ap_iss_country=R_EUR    ap_origin=R_NAM    ap_destination=R_EUR    ap_score=2.80
    ...    ap_policy_order=8
    Generate Test Variables And Data For Agency Preferences    row_id=7    ap_carrier_code=A2    ap_iss_country=R_EUR    ap_origin=R_NAM    ap_destination=G_YYYY    ap_score=2.90
    ...    ap_policy_order=8
    # Multiple Matching AP Data With Origin Global And POS Region
    Generate Test Variables And Data For Agency Preferences    row_id=8    ap_carrier_code=A3    ap_iss_country=R_EUR    ap_origin=G_YYYY    ap_destination=A_LHR    ap_score=3.00
    ...    ap_policy_order=9
    Generate Test Variables And Data For Agency Preferences    row_id=8    ap_carrier_code=A4    ap_iss_country=R_EUR    ap_origin=G_YYYY    ap_destination=C_GB    ap_score=3.10
    ...    ap_policy_order=9
    Generate Test Variables And Data For Agency Preferences    row_id=8    ap_carrier_code=A5    ap_iss_country=R_EUR    ap_origin=G_YYYY    ap_destination=R_EUR    ap_score=3.20
    ...    ap_policy_order=9
    Generate Test Variables And Data For Agency Preferences    row_id=8    ap_carrier_code=A6    ap_iss_country=R_EUR    ap_origin=G_YYYY    ap_destination=G_YYYY    ap_score=3.30
    ...    ap_policy_order=9
    # Multiple Matching CP Data
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AA    cp_origin=A_JFK    cp_destination=A_LHR    cp_policy_order=1
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AB    cp_origin=A_JFK    cp_destination=CI_LON    cp_policy_order=2
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AC    cp_origin=CI_NYC    cp_destination=A_LHR    cp_policy_order=3
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AD    cp_origin=A_JFK    cp_destination=C_GB    cp_policy_order=4
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AE    cp_origin=C_US    cp_destination=A_LHR    cp_policy_order=5
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AF    cp_origin=A_JFK    cp_destination=SR_EUROP    cp_policy_order=6
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AG    cp_origin=SR_NAMER    cp_destination=A_LHR    cp_policy_order=7
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AH    cp_origin=A_JFK    cp_destination=R_EMEA    cp_policy_order=8
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AI    cp_origin=R_NORAM    cp_destination=A_LHR    cp_policy_order=9
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AJ    cp_origin=A_JFK    cp_destination=G_YYYY    cp_policy_order=10
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AK    cp_origin=G_YYYY    cp_destination=A_LHR    cp_policy_order=11
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AL    cp_origin=CI_NYC    cp_destination=CI_LON    cp_policy_order=12
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AM    cp_origin=CI_NYC    cp_destination=C_GB    cp_policy_order=13
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AN    cp_origin=C_US    cp_destination=CI_LON    cp_policy_order=14
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AO    cp_origin=CI_NYC    cp_destination=SR_EUROP    cp_policy_order=15
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AP    cp_origin=SR_NAMER    cp_destination=CI_LON    cp_policy_order=16
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AQ    cp_origin=CI_NYC    cp_destination=R_EMEA    cp_policy_order=17
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AR    cp_origin=R_NORAM    cp_destination=CI_LON    cp_policy_order=18
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AS    cp_origin=CI_NYC    cp_destination=G_YYYY    cp_policy_order=19
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AT    cp_origin=G_YYYY    cp_destination=CI_LON    cp_policy_order=20
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AU    cp_origin=C_US    cp_destination=C_GB    cp_policy_order=21
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AV    cp_origin=C_US    cp_destination=SR_EUROP    cp_policy_order=22
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AW    cp_origin=SR_NAMER    cp_destination=C_GB    cp_policy_order=23
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AX    cp_origin=C_US    cp_destination=R_EMEA    cp_policy_order=24
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AY    cp_origin=R_NORAM    cp_destination=C_GB    cp_policy_order=25
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=AZ    cp_origin=C_US    cp_destination=G_YYYY    cp_policy_order=26
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A0    cp_origin=G_YYYY    cp_destination=C_GB    cp_policy_order=27
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A1    cp_origin=SR_NAMER    cp_destination=SR_EUROP    cp_policy_order=28
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A2    cp_origin=SR_NAMER    cp_destination=R_EMEA    cp_policy_order=29
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A3    cp_origin=R_NORAM    cp_destination=SR_EUROP    cp_policy_order=30
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A4    cp_origin=SR_NAMER    cp_destination=G_YYYY    cp_policy_order=31
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A5    cp_origin=G_YYYY    cp_destination=SR_EUROP    cp_policy_order=32
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A6    cp_origin=R_NORAM    cp_destination=R_EMEA    cp_policy_order=33
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A7    cp_origin=R_NORAM    cp_destination=G_YYYY    cp_policy_order=34
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A8    cp_origin=G_YYYY    cp_destination=R_EMEA    cp_policy_order=35
    Generate Test Variables And Data For Client Preferences    cp_csu_guid=A:1234    cp_carrier_code=A9    cp_origin=G_YYYY    cp_destination=G_YYYY    cp_policy_order=36
    #Matching Boost Data
    Generate Test Variables And Data For Boost    boost_ap=0.3    boost_cp=0.3
    Send GET request
    Comment    Calculate And Compare Dynamic Scores    6    0.3    apScore
    Comment    Calculate And Compare Dynamic Scores    6    0.3    cpScore
    Verify That Correct Status Code Are Returned    200
    Verify That Response Headers Are Correct
    Comment    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"DATASET_${prefix}","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.3,"cpScore":0.3,"totalScore":0.6},{"carrierCode":"AE","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.25714287,"cpScore":0.25714287,"totalScore":0.51428574},{"carrierCode":"AI","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.21428573,"cpScore":0.21428573,"totalScore":0.42857146},{"carrierCode":"AU","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.17142859,"cpScore":0.17142859,"totalScore":0.34285718},{"carrierCode":"AY","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.12857144,"cpScore":0.12857144,"totalScore":0.25714287},{"carrierCode":"A3","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.085714296,"cpScore":0.085714296,"totalScore":0.17142859}],"travelerPreference":{"traveler_guid":"C:8901","carrier":[{"code":"AA","value":0.1},{"code":"AE","value":0.2},{"code":"AI","value":0.3},{"code":"AU","value":0.6},{"code":"AY","value":0.7},{"code":"A3","value":0.8}],"depart_ts":{"ts_window_1":0.1,"ts_window_2":0.2,"ts_window_n":0.3},"arrival_ts":{"ts_window_1":0.4,"ts_window_2":0.5,"ts_window_n":0.6},"num_stops":{"n0":0.7,"n1":0.8,"n2":0.7},"duration":0.6,"price":0.5},"boost":{"tpBoost":0.5,"cpBoost":0.3,"apBoost":0.3,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.8,"cpScore":0.9,"totalScore":1.7},{"carrierCode":"AE","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.6857143,"cpScore":0.7714286,"totalScore":1.4571428},{"carrierCode":"AU","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.4571429,"cpScore":0.51428574,"totalScore":0.97142863},{"carrierCode":"AI","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.5714286,"cpScore":0.64285713,"totalScore":1.2142857},{"carrierCode":"AY","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.34285715,"cpScore":0.3857143,"totalScore":0.7285714},{"carrierCode":"A3","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","apScore":0.22857144,"cpScore":0.25714287,"totalScore":0.48571432}]}}}
    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"${prefix}","offlineAlgorithm": "${offline_algorithm}","onlineAlgorithm": "${online_algorithm}","result":{"score":[{"carrierCode":"AA","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apPolicyOrder":2,"apDerivedPolicyOrder":1,"apScore":0.3,"cpScore":0.3,"totalScore":0.6},{"carrierCode":"AE","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":5,"cpDerivedPolicyOrder":2,"apPolicyOrder":3,"apDerivedPolicyOrder":2,"apScore":0.25714287,"cpScore":0.25714287,"totalScore":0.51428574},{"carrierCode":"AI","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":9,"cpDerivedPolicyOrder":3,"apPolicyOrder":4,"apDerivedPolicyOrder":3,"apScore":0.21428573,"cpScore":0.21428573,"totalScore":0.42857146},{"carrierCode":"AU","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":21,"cpDerivedPolicyOrder":4,"apPolicyOrder":7,"apDerivedPolicyOrder":4,"apScore":0.17142859,"cpScore":0.17142859,"totalScore":0.34285718},{"carrierCode":"AY","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":25,"cpDerivedPolicyOrder":5,"apPolicyOrder":8,"apDerivedPolicyOrder":5,"apScore":0.12857144,"cpScore":0.12857144,"totalScore":0.25714287},{"carrierCode":"A3","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":30,"cpDerivedPolicyOrder":6,"apPolicyOrder":9,"apDerivedPolicyOrder":6,"apScore":0.085714296,"cpScore":0.085714296,"totalScore":0.17142859}],"travelerPreference":{"traveler_guid":"C:8901","carrier":[{"code":"AA","value":0.1},{"code":"AE","value":0.2},{"code":"AI","value":0.3},{"code":"AU","value":0.6},{"code":"AY","value":0.7},{"code":"A3","value":0.8}],"depart_ts":{"ts_window_1":0.1,"ts_window_2":0.2,"ts_window_n":0.3},"arrival_ts":{"ts_window_1":0.4,"ts_window_2":0.5,"ts_window_n":0.6},"num_stops":{"n0":0.7,"n1":0.8,"n2":0.7},"duration":0.6,"price":0.5},"boost":{"tpBoost":0.5,"cpBoost":0.3,"apBoost":0.3,"priceBoost":${price},"durationBoost":${duration},"numStopsBoost":${num_stops},"flightTimeBoost":${flight_time}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AA","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apPolicyOrder":2,"apDerivedPolicyOrder":1,"apScore":0.8,"cpScore":0.9,"totalScore":1.7},{"carrierCode":"AE","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":5,"cpDerivedPolicyOrder":2,"apPolicyOrder":3,"apDerivedPolicyOrder":2,"apScore":0.6857143,"cpScore":0.7714286,"totalScore":1.4571428},{"carrierCode":"AU","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":21,"cpDerivedPolicyOrder":4,"apPolicyOrder":7,"apDerivedPolicyOrder":4,"apScore":0.4571429,"cpScore":0.51428574,"totalScore":0.97142863},{"carrierCode":"AI","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":9,"cpDerivedPolicyOrder":3,"apPolicyOrder":4,"apDerivedPolicyOrder":3,"apScore":0.5714286,"cpScore":0.64285713,"totalScore":1.2142857},{"carrierCode":"AY","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":25,"cpDerivedPolicyOrder":5,"apPolicyOrder":8,"apDerivedPolicyOrder":5,"apScore":0.34285715,"cpScore":0.3857143,"totalScore":0.7285714},{"carrierCode":"A3","cabinType":"BUS","origin":"JFK","destination":"LHR","issuingCountry":"GB","cpPolicyOrder":30,"cpDerivedPolicyOrder":6,"apPolicyOrder":9,"apDerivedPolicyOrder":6,"apScore":0.22857144,"cpScore":0.25714287,"totalScore":0.48571432}]}}}
    [Teardown]    Delete All Redis Keys Using Pattern    CARRIERS::*

FNC_083 Score Is Successfully Retrieved When AP,CP,TP Version Is V2 and Boost Version Is V1.
    Delete All Versions Redis Keys
    Create TP Meta Data
    # Request
    Generate Test Variables For Get Personalization Admin Score    trv_guid=A:1234    iss_country=US    origin=JFK    destination=LHR    dep_date=20181201    csu_guid=A:1234
    ...    prefix=A
    Create Test Data For Metadata    group=A    api_version=v2    ap_version=v2    cp_version=v2    tp_version=v2    boost_version=v1
    Generate Test Data For Traveler Preference 2    V2,A:1234    #tp_version=V2
    # AP Data With V2
    Generate Test Variables And Data For Agency Preferences    ap_version=V2    ap_carrier_code=AC    ap_iss_country=C_US    ap_origin=A_JFK    ap_destination=A_LHR    ap_score=0.1
    ...    ap_policy_order=1    row_id=1
    Generate Test Variables And Data For Agency Preferences    ap_version=V2    ap_carrier_code=AD    ap_iss_country=C_US    ap_origin=A_JFK    ap_destination=A_LHR    ap_score=0.1
    ...    ap_policy_order=2    row_id=2
    # CP Data With V2
    Generate Test Variables And Data For Client Preferences    cp_version=V2    cp_csu_guid=A:1234    cp_carrier_code=BC    cp_origin=A_JFK    cp_destination=A_LHR    cp_policy_order=1
    Generate Test Variables And Data For Client Preferences    cp_version=V2    cp_csu_guid=A:1234    cp_carrier_code=BD    cp_origin=A_JFK    cp_destination=CI_LON    cp_policy_order=2
    # Boost Data With V1
    Generate Test Variables And Data For Boost    api_version=v2    boost_cp=0.4    boost_ap=0.3    boost_version=V1
    Send GET request
    Comment    Calculate And Compare Dynamic Scores    2    0.3    apScore
    Comment    Calculate And Compare Dynamic Scores    2    0.4    cpScore
    Verify That Correct Status Code Are Returned    200
    Verify That Response Headers Are Correct
    Comment    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"DATASET_${prefix}","result":{"score":[{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.3,"cpScore":0.0,"totalScore":0.3},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.20000002,"cpScore":0.0,"totalScore":0.20000002},{"carrierCode":"BC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"BD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.26666668,"totalScore":0.26666668}],"travelerPreference":${V2_${trv_guid}_trv_data},"boost":{"consumer":"MyCWT_Mobile","tpBoost":0.5,"cpBoost":0.4,"apBoost":0.3,"others":{"Factor1":"test"}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.2,"cpScore":0.0,"totalScore":0.2},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.13333334,"cpScore":0.0,"totalScore":0.13333334},{"carrierCode":"BC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.3,"totalScore":0.3},{"carrierCode":"BD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apScore":0.0,"cpScore":0.20000002,"totalScore":0.20000002}]}}}
    Verify That Personalization Score Is Returned    {"scoreAPI":{"version":"${latest_version}","experimentGroupTypeCode":"${prefix}","offlineAlgorithm": "${offline_algorithm}","onlineAlgorithm": "${online_algorithm}","result":{"score":[{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.3,"cpScore":0.0,"totalScore":0.3},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apPolicyOrder":2,"apDerivedPolicyOrder":2,"apScore":0.20000002,"cpScore":0.0,"totalScore":0.20000002},{"carrierCode":"BC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.4,"totalScore":0.4},{"carrierCode":"BD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":2,"cpDerivedPolicyOrder":2,"apScore":0.0,"cpScore":0.26666668,"totalScore":0.26666668}],"travelerPreference":${V2_${trv_guid}_trv_data},"boost":{"consumer":"MyCWT_Mobile","tpBoost":0.5,"cpBoost":0.4,"apBoost":0.3,"others":{"Factor1":"test"}}}},"adhoc":{"version":"${latest_version}","experimentGroupTypeCode":"adhoc","result":{"score":[{"carrierCode":"AC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apPolicyOrder":1,"apDerivedPolicyOrder":1,"apScore":0.2,"cpScore":0.0,"totalScore":0.2},{"carrierCode":"AD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","apPolicyOrder":2,"apDerivedPolicyOrder":2,"apScore":0.13333334,"cpScore":0.0,"totalScore":0.13333334},{"carrierCode":"BC","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":1,"cpDerivedPolicyOrder":1,"apScore":0.0,"cpScore":0.3,"totalScore":0.3},{"carrierCode":"BD","cabinType":"${cabin_type}","origin":"${origin}","destination":"${destination}","issuingCountry":"${iss_country}","cpPolicyOrder":2,"cpDerivedPolicyOrder":2,"apScore":0.0,"cpScore":0.20000002,"totalScore":0.20000002}]}}}
