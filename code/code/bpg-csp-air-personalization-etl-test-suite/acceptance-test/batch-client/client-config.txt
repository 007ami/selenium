*** Settings ***
Test Setup        Send Authenticate Post Request And Get Token
Test Teardown     Delete Stubs
Force Tags        client_config    regression
Resource          resources/batch-client.txt

*** Test Cases ***
FNC_001 Verify That Client Config Lambda With Powerbase API Is Triggered When StartTimestamp Is Default
    Get Current Time With Pattern
    Flush All Redis Keys
    Delete Clients Collecton In MongoDB
    Create Success Stub For Powerbase API    request={"urlPattern":"${wiremock_pb_url}${pb_uri_oauth}.+","method":"POST"}    response=${pb_oauth_response}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "1"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-0-0","ClientTopUnitGuid":"0:0","ClientSubUnitName":"CSU-Test_0-0","ClientSubUnitGuid":"14:3B67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-1-1","ClientTopUnitGuid":"1:1","ClientSubUnitName":"CSU-Test_1-1","ClientSubUnitGuid":"15:3C68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-2-2","ClientTopUnitGuid":"2:2","ClientSubUnitName":"CSU-Test_2-2","ClientSubUnitGuid":"16:3D69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-3-3","ClientTopUnitGuid":"3:3","ClientSubUnitName":"CSU-Test_3-3","ClientSubUnitGuid":"17:3E61","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-4-4","ClientTopUnitGuid":"4:4","ClientSubUnitName":"CSU-Test_4-4","ClientSubUnitGuid":"18:3F62","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-5-5","ClientTopUnitGuid":"5:5","ClientSubUnitName":"CSU-Test_5-5","ClientSubUnitGuid":"19:3G63","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-6-6","ClientTopUnitGuid":"6:6","ClientSubUnitName":"CSU-Test_6-6","ClientSubUnitGuid":"20:3H64","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-7-7","ClientTopUnitGuid":"7:7","ClientSubUnitName":"CSU-Test_7-7","ClientSubUnitGuid":"21:3I65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-8-8","ClientTopUnitGuid":"8:8","ClientSubUnitName":"CSU-Test_8-8","ClientSubUnitGuid":"22:3J66","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-9-9","ClientTopUnitGuid":"9:9","ClientSubUnitName":"CSU-Test_9-9","ClientSubUnitGuid":"23:3K67","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "3"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-10-10","ClientTopUnitGuid":"10:10","ClientSubUnitName":"CSU-Test_10-10","ClientSubUnitGuid":"24:3D70","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-11-11","ClientTopUnitGuid":"11:11","ClientSubUnitName":"CSU-Test_11-11","ClientSubUnitGuid":"25:3H65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-12-12","ClientTopUnitGuid":"12:12","ClientSubUnitName":"CSU-Test_12-12","ClientSubUnitGuid":"26:3J67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-13-13","ClientTopUnitGuid":"13:13","ClientSubUnitName":"CSU-Test_13-13","ClientSubUnitGuid":"27:3K68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-14-14","ClientTopUnitGuid":"14:14","ClientSubUnitName":"CSU-Test_14-14","ClientSubUnitGuid":"28:3K69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-15-15","ClientTopUnitGuid":"15:15","ClientSubUnitName":"CSU-Test_15-15","ClientSubUnitGuid":"29:3K70","CountryCode":"US"}]}
    Create Error Stub For Endpoints For Client Config    204    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "4"}},"method":"GET"}    response={"Code":202,"Error":"NO_DATA_FOUND","Description":"request did not yield any result"}
    Replace Strings In Variables    CONFIG::CLIENT::MAPPINGS_data,"30:3K71":"16:16",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"31:3K72":"17:17",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"32:3K73":"18:18",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"33:3K74":"19:19",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"34:3K75":"20:20",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"35:3K76":"21:21",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"36:3K77":"22:22",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"37:3K78":"23:23",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"38:3K79":"24:24",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"39:3K80":"25:25",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"40:3K81":"26:26",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"41:3K82":"27:27",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"42:3K83":"28:28",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"43:3K84":"29:29",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"44:3K85":"30:30",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"45:3K86":"31:31",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"46:3K87":"32:32",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"47:3K88":"33:33",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"48:3K89":"34:34",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"49:3K90":"35:35",${EMPTY}
    Trigger Lambda Function With Payload    ${config_data_lambda_func}    payload="{\\\"startTimestamp\\\":\\\"1970-01-01 00:00:00.000\\\"}"
    Verify That Redis Keys Are Correct    CONFIG::CLIENT::MAPPINGS|ETL::CLIENTCONFIG|CONFIG::CLIENT::LASTMODIFIED
    Verify Redis Hash Data    CONFIG::CLIENT::MAPPINGS
    Verify Redis List Data    ETL::CLIENTCONFIG,COMPLETE
    Verify Redis String Data    CONFIG::CLIENT::LASTMODIFIED    pattern=${current_date_data}
    Send GET Request For Admin Clients
    Verify That Correct Client Data Is Returned    [{'clientTopGUID': '2:2', 'clientTopName': 'ClientTop-test-2-2', 'subunits': [{'clientSubGUID': '16:3D69', 'clientSubName': 'CSU-Test_2-2', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '7:7', 'clientTopName': 'ClientTop-test-7-7', 'subunits': [{'clientSubGUID': '21:3I65', 'clientSubName': 'CSU-Test_7-7', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '4:4', 'clientTopName': 'ClientTop-test-4-4', 'subunits': [{'clientSubGUID': '18:3F62', 'clientSubName': 'CSU-Test_4-4', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '9:9', 'clientTopName': 'ClientTop-test-9-9', 'subunits': [{'clientSubGUID': '23:3K67', 'clientSubName': 'CSU-Test_9-9', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '3:3', 'clientTopName': 'ClientTop-test-3-3', 'subunits': [{'clientSubGUID': '17:3E61', 'clientSubName': 'CSU-Test_3-3', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '8:8', 'clientTopName': 'ClientTop-test-8-8', 'subunits': [{'clientSubGUID': '22:3J66', 'clientSubName': 'CSU-Test_8-8', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '1:1', 'clientTopName': 'ClientTop-test-1-1', 'subunits': [{'clientSubGUID': '15:3C68', 'clientSubName': 'CSU-Test_1-1', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '6:6', 'clientTopName': 'ClientTop-test-6-6', 'subunits': [{'clientSubGUID': '20:3H64', 'clientSubName': 'CSU-Test_6-6', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '0:0', 'clientTopName': 'ClientTop-test-0-0', 'subunits': [{'clientSubGUID': '14:3B67', 'clientSubName': 'CSU-Test_0-0', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '5:5', 'clientTopName': 'ClientTop-test-5-5', 'subunits': [{'clientSubGUID': '19:3G63', 'clientSubName': 'CSU-Test_5-5', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '10:10', 'clientTopName': 'ClientTop-test-10-10', 'subunits': [{'clientSubGUID': '24:3D70', 'clientSubName': 'CSU-Test_10-10', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '11:11', 'clientTopName': 'ClientTop-test-11-11', 'subunits': [{'clientSubGUID': '25:3H65', 'clientSubName': 'CSU-Test_11-11', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '12:12', 'clientTopName': 'ClientTop-test-12-12', 'subunits': [{'clientSubGUID': '26:3J67', 'clientSubName': 'CSU-Test_12-12', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '13:13', 'clientTopName': 'ClientTop-test-13-13', 'subunits': [{'clientSubGUID': '27:3K68', 'clientSubName': 'CSU-Test_13-13', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '14:14', 'clientTopName': 'ClientTop-test-14-14', 'subunits': [{'clientSubGUID': '28:3K69', 'clientSubName': 'CSU-Test_14-14', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '15:15', 'clientTopName': 'ClientTop-test-15-15', 'subunits': [{'clientSubGUID': '29:3K70', 'clientSubName': 'CSU-Test_15-15', 'country': {'countryCode': 'US'}}]}]

FNC_002 Verify That Client Config Lambda With Powerbase API Is Triggered When StartTimestamp Is Default And LastModifiedDate
    Get Current Time With Pattern
    Flush All Redis Keys
    Delete Clients Collecton In MongoDB
    Update Last Modified Date In Redis    last_modified_date=2000-01-01 00:00:00.000
    Create Success Stub For Powerbase API    request={"urlPattern":"${wiremock_pb_url}${pb_uri_oauth}.+","method":"POST"}    response=${pb_oauth_response}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2000-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "1"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-0-0","ClientTopUnitGuid":"0:0","ClientSubUnitName":"CSU-Test_0-0","ClientSubUnitGuid":"14:3B67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-1-1","ClientTopUnitGuid":"1:1","ClientSubUnitName":"CSU-Test_1-1","ClientSubUnitGuid":"15:3C68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-2-2","ClientTopUnitGuid":"2:2","ClientSubUnitName":"CSU-Test_2-2","ClientSubUnitGuid":"16:3D69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-3-3","ClientTopUnitGuid":"3:3","ClientSubUnitName":"CSU-Test_3-3","ClientSubUnitGuid":"17:3E61","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-4-4","ClientTopUnitGuid":"4:4","ClientSubUnitName":"CSU-Test_4-4","ClientSubUnitGuid":"18:3F62","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2000-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-5-5","ClientTopUnitGuid":"5:5","ClientSubUnitName":"CSU-Test_5-5","ClientSubUnitGuid":"19:3G63","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-6-6","ClientTopUnitGuid":"6:6","ClientSubUnitName":"CSU-Test_6-6","ClientSubUnitGuid":"20:3H64","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-7-7","ClientTopUnitGuid":"7:7","ClientSubUnitName":"CSU-Test_7-7","ClientSubUnitGuid":"21:3I65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-8-8","ClientTopUnitGuid":"8:8","ClientSubUnitName":"CSU-Test_8-8","ClientSubUnitGuid":"22:3J66","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-9-9","ClientTopUnitGuid":"9:9","ClientSubUnitName":"CSU-Test_9-9","ClientSubUnitGuid":"23:3K67","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2000-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "3"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-10-10","ClientTopUnitGuid":"10:10","ClientSubUnitName":"CSU-Test_10-10","ClientSubUnitGuid":"24:3D70","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-11-11","ClientTopUnitGuid":"11:11","ClientSubUnitName":"CSU-Test_11-11","ClientSubUnitGuid":"25:3H65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-12-12","ClientTopUnitGuid":"12:12","ClientSubUnitName":"CSU-Test_12-12","ClientSubUnitGuid":"26:3J67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-13-13","ClientTopUnitGuid":"13:13","ClientSubUnitName":"CSU-Test_13-13","ClientSubUnitGuid":"27:3K68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-14-14","ClientTopUnitGuid":"14:14","ClientSubUnitName":"CSU-Test_14-14","ClientSubUnitGuid":"28:3K69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-15-15","ClientTopUnitGuid":"15:15","ClientSubUnitName":"CSU-Test_15-15","ClientSubUnitGuid":"29:3K70","CountryCode":"US"}]}
    Create Error Stub For Endpoints For Client Config    204    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2000-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "4"}},"method":"GET"}    response={"Code":202,"Error":"NO_DATA_FOUND","Description":"request did not yield any result"}
    Replace Strings In Variables    CONFIG::CLIENT::MAPPINGS_data,"30:3K71":"16:16",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"31:3K72":"17:17",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"32:3K73":"18:18",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"33:3K74":"19:19",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"34:3K75":"20:20",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"35:3K76":"21:21",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"36:3K77":"22:22",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"37:3K78":"23:23",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"38:3K79":"24:24",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"39:3K80":"25:25",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"40:3K81":"26:26",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"41:3K82":"27:27",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"42:3K83":"28:28",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"43:3K84":"29:29",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"44:3K85":"30:30",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"45:3K86":"31:31",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"46:3K87":"32:32",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"47:3K88":"33:33",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"48:3K89":"34:34",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"49:3K90":"35:35",${EMPTY}
    Trigger Lambda Function With Payload    ${config_data_lambda_func}    payload="{\\\"startTimestamp\\\":\\\"2000-01-01 00:00:00.000\\\"}"
    Verify That Redis Keys Are Correct    CONFIG::CLIENT::MAPPINGS|ETL::CLIENTCONFIG|CONFIG::CLIENT::LASTMODIFIED
    Verify Redis Hash Data    CONFIG::CLIENT::MAPPINGS
    Verify Redis List Data    ETL::CLIENTCONFIG,COMPLETE
    Verify Redis String Data    CONFIG::CLIENT::LASTMODIFIED    pattern=${current_date_data}
    Send GET Request For Admin Clients
    Verify That Correct Client Data Is Returned    [{'clientTopGUID': '2:2', 'clientTopName': 'ClientTop-test-2-2', 'subunits': [{'clientSubGUID': '16:3D69', 'clientSubName': 'CSU-Test_2-2', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '7:7', 'clientTopName': 'ClientTop-test-7-7', 'subunits': [{'clientSubGUID': '21:3I65', 'clientSubName': 'CSU-Test_7-7', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '4:4', 'clientTopName': 'ClientTop-test-4-4', 'subunits': [{'clientSubGUID': '18:3F62', 'clientSubName': 'CSU-Test_4-4', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '9:9', 'clientTopName': 'ClientTop-test-9-9', 'subunits': [{'clientSubGUID': '23:3K67', 'clientSubName': 'CSU-Test_9-9', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '3:3', 'clientTopName': 'ClientTop-test-3-3', 'subunits': [{'clientSubGUID': '17:3E61', 'clientSubName': 'CSU-Test_3-3', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '8:8', 'clientTopName': 'ClientTop-test-8-8', 'subunits': [{'clientSubGUID': '22:3J66', 'clientSubName': 'CSU-Test_8-8', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '1:1', 'clientTopName': 'ClientTop-test-1-1', 'subunits': [{'clientSubGUID': '15:3C68', 'clientSubName': 'CSU-Test_1-1', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '6:6', 'clientTopName': 'ClientTop-test-6-6', 'subunits': [{'clientSubGUID': '20:3H64', 'clientSubName': 'CSU-Test_6-6', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '0:0', 'clientTopName': 'ClientTop-test-0-0', 'subunits': [{'clientSubGUID': '14:3B67', 'clientSubName': 'CSU-Test_0-0', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '5:5', 'clientTopName': 'ClientTop-test-5-5', 'subunits': [{'clientSubGUID': '19:3G63', 'clientSubName': 'CSU-Test_5-5', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '10:10', 'clientTopName': 'ClientTop-test-10-10', 'subunits': [{'clientSubGUID': '24:3D70', 'clientSubName': 'CSU-Test_10-10', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '11:11', 'clientTopName': 'ClientTop-test-11-11', 'subunits': [{'clientSubGUID': '25:3H65', 'clientSubName': 'CSU-Test_11-11', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '12:12', 'clientTopName': 'ClientTop-test-12-12', 'subunits': [{'clientSubGUID': '26:3J67', 'clientSubName': 'CSU-Test_12-12', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '13:13', 'clientTopName': 'ClientTop-test-13-13', 'subunits': [{'clientSubGUID': '27:3K68', 'clientSubName': 'CSU-Test_13-13', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '14:14', 'clientTopName': 'ClientTop-test-14-14', 'subunits': [{'clientSubGUID': '28:3K69', 'clientSubName': 'CSU-Test_14-14', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '15:15', 'clientTopName': 'ClientTop-test-15-15', 'subunits': [{'clientSubGUID': '29:3K70', 'clientSubName': 'CSU-Test_15-15', 'country': {'countryCode': 'US'}}]}]

FNC_003 Verify That Client Config Lambda With Powerbase API Is Triggered When StartTimestamp Is Default And LastModifiedDate With Same Stubbing
    Get Current Time With Pattern
    Flush All Redis Keys
    Delete Clients Collecton In MongoDB
    Create Success Stub For Powerbase API    request={"urlPattern":"${wiremock_pb_url}${pb_uri_oauth}.+","method":"POST"}    response=${pb_oauth_response}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "1"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-0-0","ClientTopUnitGuid":"0:0","ClientSubUnitName":"CSU-Test_0-0","ClientSubUnitGuid":"14:3B67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-1-1","ClientTopUnitGuid":"1:1","ClientSubUnitName":"CSU-Test_1-1","ClientSubUnitGuid":"15:3C68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-2-2","ClientTopUnitGuid":"2:2","ClientSubUnitName":"CSU-Test_2-2","ClientSubUnitGuid":"16:3D69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-3-3","ClientTopUnitGuid":"3:3","ClientSubUnitName":"CSU-Test_3-3","ClientSubUnitGuid":"17:3E61","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-4-4","ClientTopUnitGuid":"4:4","ClientSubUnitName":"CSU-Test_4-4","ClientSubUnitGuid":"18:3F62","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-5-5","ClientTopUnitGuid":"5:5","ClientSubUnitName":"CSU-Test_5-5","ClientSubUnitGuid":"19:3G63","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-6-6","ClientTopUnitGuid":"6:6","ClientSubUnitName":"CSU-Test_6-6","ClientSubUnitGuid":"20:3H64","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-7-7","ClientTopUnitGuid":"7:7","ClientSubUnitName":"CSU-Test_7-7","ClientSubUnitGuid":"21:3I65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-8-8","ClientTopUnitGuid":"8:8","ClientSubUnitName":"CSU-Test_8-8","ClientSubUnitGuid":"22:3J66","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-9-9","ClientTopUnitGuid":"9:9","ClientSubUnitName":"CSU-Test_9-9","ClientSubUnitGuid":"23:3K67","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "3"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-10-10","ClientTopUnitGuid":"10:10","ClientSubUnitName":"CSU-Test_10-10","ClientSubUnitGuid":"24:3D70","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-11-11","ClientTopUnitGuid":"11:11","ClientSubUnitName":"CSU-Test_11-11","ClientSubUnitGuid":"25:3H65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-12-12","ClientTopUnitGuid":"12:12","ClientSubUnitName":"CSU-Test_12-12","ClientSubUnitGuid":"26:3J67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-13-13","ClientTopUnitGuid":"13:13","ClientSubUnitName":"CSU-Test_13-13","ClientSubUnitGuid":"27:3K68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-14-14","ClientTopUnitGuid":"14:14","ClientSubUnitName":"CSU-Test_14-14","ClientSubUnitGuid":"28:3K69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-15-15","ClientTopUnitGuid":"15:15","ClientSubUnitName":"CSU-Test_15-15","ClientSubUnitGuid":"29:3K70","CountryCode":"US"}]}
    Create Error Stub For Endpoints For Client Config    204    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "4"}},"method":"GET"}    response={"Code":202,"Error":"NO_DATA_FOUND","Description":"request did not yield any result"}
    Trigger Lambda Function With Payload    ${config_data_lambda_func}    payload="{\\\"startTimestamp\\\":\\\"1970-01-01 00:00:00.000\\\"}"
    #2nd Run
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "1"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-0-0","ClientTopUnitGuid":"0:0","ClientSubUnitName":"CSU-Test_0-0","ClientSubUnitGuid":"14:3B67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-1-1","ClientTopUnitGuid":"1:1","ClientSubUnitName":"CSU-Test_1-1","ClientSubUnitGuid":"15:3C68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-2-2","ClientTopUnitGuid":"2:2","ClientSubUnitName":"CSU-Test_2-2","ClientSubUnitGuid":"16:3D69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-3-3","ClientTopUnitGuid":"3:3","ClientSubUnitName":"CSU-Test_3-3","ClientSubUnitGuid":"17:3E61","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-4-4","ClientTopUnitGuid":"4:4","ClientSubUnitName":"CSU-Test_4-4","ClientSubUnitGuid":"18:3F62","CountryCode":"PH"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-16-16","ClientTopUnitGuid":"16:16","ClientSubUnitName":"CSU-Test_16-16","ClientSubUnitGuid":"30:3K71","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-17-17","ClientTopUnitGuid":"17:17","ClientSubUnitName":"CSU-Test_17-17","ClientSubUnitGuid":"31:3K72","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-18-18","ClientTopUnitGuid":"18:18","ClientSubUnitName":"CSU-Test_18-18","ClientSubUnitGuid":"32:3K73","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-19-19","ClientTopUnitGuid":"19:19","ClientSubUnitName":"CSU-Test_19-19","ClientSubUnitGuid":"33:3K74","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-20-20","ClientTopUnitGuid":"20:20","ClientSubUnitName":"CSU-Test_20-20","ClientSubUnitGuid":"34:3K75","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "3"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-21-21","ClientTopUnitGuid":"21:21","ClientSubUnitName":"CSU-Test_21-21","ClientSubUnitGuid":"35:3K76","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-22-22","ClientTopUnitGuid":"22:22","ClientSubUnitName":"CSU-Test_22-22","ClientSubUnitGuid":"36:3K77","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-23-23","ClientTopUnitGuid":"23:23","ClientSubUnitName":"CSU-Test_23-23","ClientSubUnitGuid":"37:3K78","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-24-24","ClientTopUnitGuid":"24:24","ClientSubUnitName":"CSU-Test_24-24","ClientSubUnitGuid":"38:3K79","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-25-25","ClientTopUnitGuid":"25:25","ClientSubUnitName":"CSU-Test_25-25","ClientSubUnitGuid":"39:3K80","CountryCode":"US"}]}
    Create Error Stub For Endpoints For Client Config    204    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "4"}},"method":"GET"}    response={"Code":202,"Error":"NO_DATA_FOUND","Description":"request did not yield any result"}
    Replace Strings In Variables    CONFIG::CLIENT::MAPPINGS_data,"40:3K81":"26:26",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"41:3K82":"27:27",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"42:3K83":"28:28",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"43:3K84":"29:29",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"44:3K85":"30:30",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"45:3K86":"31:31",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"46:3K87":"32:32",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"47:3K88":"33:33",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"48:3K89":"34:34",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"49:3K90":"35:35",${EMPTY}
    Trigger Lambda Function    ${config_data_lambda_func}    ETL_list=ETL::CLIENTCONFIG
    Verify That Redis Keys Are Correct    CONFIG::CLIENT::MAPPINGS|ETL::CLIENTCONFIG|CONFIG::CLIENT::LASTMODIFIED
    Verify Redis Hash Data    CONFIG::CLIENT::MAPPINGS
    Verify Redis List Data    ETL::CLIENTCONFIG,COMPLETE
    Verify Redis String Data    CONFIG::CLIENT::LASTMODIFIED    pattern=${current_date_data}
    Send GET Request For Admin Clients
    Verify That Correct Client Data Is Returned    [{'clientTopGUID': '2:2', 'clientTopName': 'ClientTop-test-2-2', 'subunits': [{'clientSubGUID': '16:3D69', 'clientSubName': 'CSU-Test_2-2', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '7:7', 'clientTopName': 'ClientTop-test-7-7', 'subunits': [{'clientSubGUID': '21:3I65', 'clientSubName': 'CSU-Test_7-7', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '4:4', 'clientTopName': 'ClientTop-test-4-4', 'subunits': [{'clientSubGUID': '18:3F62', 'clientSubName': 'CSU-Test_4-4', 'country': {'countryCode': 'PH'}}]},{'clientTopGUID': '9:9', 'clientTopName': 'ClientTop-test-9-9', 'subunits': [{'clientSubGUID': '23:3K67', 'clientSubName': 'CSU-Test_9-9', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '3:3', 'clientTopName': 'ClientTop-test-3-3', 'subunits': [{'clientSubGUID': '17:3E61', 'clientSubName': 'CSU-Test_3-3', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '8:8', 'clientTopName': 'ClientTop-test-8-8', 'subunits': [{'clientSubGUID': '22:3J66', 'clientSubName': 'CSU-Test_8-8', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '1:1', 'clientTopName': 'ClientTop-test-1-1', 'subunits': [{'clientSubGUID': '15:3C68', 'clientSubName': 'CSU-Test_1-1', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '6:6', 'clientTopName': 'ClientTop-test-6-6', 'subunits': [{'clientSubGUID': '20:3H64', 'clientSubName': 'CSU-Test_6-6', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '0:0', 'clientTopName': 'ClientTop-test-0-0', 'subunits': [{'clientSubGUID': '14:3B67', 'clientSubName': 'CSU-Test_0-0', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '5:5', 'clientTopName': 'ClientTop-test-5-5', 'subunits': [{'clientSubGUID': '19:3G63', 'clientSubName': 'CSU-Test_5-5', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '10:10', 'clientTopName': 'ClientTop-test-10-10', 'subunits': [{'clientSubGUID': '24:3D70', 'clientSubName': 'CSU-Test_10-10', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '11:11', 'clientTopName': 'ClientTop-test-11-11', 'subunits': [{'clientSubGUID': '25:3H65', 'clientSubName': 'CSU-Test_11-11', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '12:12', 'clientTopName': 'ClientTop-test-12-12', 'subunits': [{'clientSubGUID': '26:3J67', 'clientSubName': 'CSU-Test_12-12', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '13:13', 'clientTopName': 'ClientTop-test-13-13', 'subunits': [{'clientSubGUID': '27:3K68', 'clientSubName': 'CSU-Test_13-13', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '14:14', 'clientTopName': 'ClientTop-test-14-14', 'subunits': [{'clientSubGUID': '28:3K69', 'clientSubName': 'CSU-Test_14-14', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '15:15', 'clientTopName': 'ClientTop-test-15-15', 'subunits': [{'clientSubGUID': '29:3K70', 'clientSubName': 'CSU-Test_15-15', 'country': {'countryCode': 'US'}}]}{'clientTopGUID': '16:16', 'clientTopName': 'ClientTop-test-16-16', 'subunits': [{'clientSubGUID': '30:3K71', 'clientSubName': 'CSU-Test_16-16', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '17:17', 'clientTopName': 'ClientTop-test-17-17', 'subunits': [{'clientSubGUID': '31:3K72', 'clientSubName': 'CSU-Test_17-17', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '18:18', 'clientTopName': 'ClientTop-test-18-18', 'subunits': [{'clientSubGUID': '32:3K73', 'clientSubName': 'CSU-Test_18-18', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '19:19', 'clientTopName': 'ClientTop-test-19-19', 'subunits': [{'clientSubGUID': '33:3K74', 'clientSubName': 'CSU-Test_19-19', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '20:20', 'clientTopName': 'ClientTop-test-20-20', 'subunits': [{'clientSubGUID': '34:3K75', 'clientSubName': 'CSU-Test_20-20', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '21:21', 'clientTopName': 'ClientTop-test-21-21', 'subunits': [{'clientSubGUID': '35:3K76', 'clientSubName': 'CSU-Test_21-21', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '22:22', 'clientTopName': 'ClientTop-test-22-22', 'subunits': [{'clientSubGUID': '36:3K77', 'clientSubName': 'CSU-Test_22-22', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '23:23', 'clientTopName': 'ClientTop-test-23-23', 'subunits': [{'clientSubGUID': '37:3K78', 'clientSubName': 'CSU-Test_23-23', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '24:24', 'clientTopName': 'ClientTop-test-24-24', 'subunits': [{'clientSubGUID': '38:3K79', 'clientSubName': 'CSU-Test_24-24', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '25:25', 'clientTopName': 'ClientTop-test-25-25', 'subunits': [{'clientSubGUID': '39:3K80', 'clientSubName': 'CSU-Test_25-25', 'country': {'countryCode': 'US'}}]}]

FNC_004 Verify That Client Config Lambda Function Is Triggered When Client Top Is Associated With Multiple Client Sub Data
    Get Current Time With Pattern
    Flush All Redis Keys
    Delete Clients Collecton In MongoDB
    # Triggered All The Endpoints
    Create Success Stub For Powerbase API    request={"urlPattern":"${wiremock_pb_url}${pb_uri_oauth}.+","method":"POST"}    response=${pb_oauth_response}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "1"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-0-0","ClientTopUnitGuid":"0:0","ClientSubUnitName":"CSU-Test_0-1","ClientSubUnitGuid":"14:3B67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-0-0","ClientTopUnitGuid":"0:0","ClientSubUnitName":"CSU-Test_0-2","ClientSubUnitGuid":"15:3C68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-0-0","ClientTopUnitGuid":"0:0","ClientSubUnitName":"CSU-Test_0-3","ClientSubUnitGuid":"16:3D69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-1-1","ClientTopUnitGuid":"1:1","ClientSubUnitName":"CSU-Test_1-1","ClientSubUnitGuid":"17:3E61","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-2-2","ClientTopUnitGuid":"2:2","ClientSubUnitName":"CSU-Test_2-1","ClientSubUnitGuid":"18:3F62","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-3-3","ClientTopUnitGuid":"3:3","ClientSubUnitName":"CSU-Test_3-1","ClientSubUnitGuid":"19:3G63","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-3-3","ClientTopUnitGuid":"3:3","ClientSubUnitName":"CSU-Test_3-2","ClientSubUnitGuid":"20:3H64","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-3-3","ClientTopUnitGuid":"3:3","ClientSubUnitName":"CSU-Test_3-3","ClientSubUnitGuid":"21:3I65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-4-4","ClientTopUnitGuid":"4:4","ClientSubUnitName":"CSU-Test_4-1","ClientSubUnitGuid":"22:3J66","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-5-5","ClientTopUnitGuid":"5:5","ClientSubUnitName":"CSU-Test_5-1","ClientSubUnitGuid":"23:3K67","CountryCode":"US"}]}
    Create Error Stub For Endpoints For Client Config    204    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "3"}},"method":"GET"}    response={"Code":202,"Error":"NO_DATA_FOUND","Description":"request did not yield any result"}
    Replace Strings In Variables    CONFIG::CLIENT::MAPPINGS_data,\"1:1\",\"0:0\"| CONFIG::CLIENT::MAPPINGS_data,\"2:2\",\"0:0\"| CONFIG::CLIENT::MAPPINGS_data,\"3:3\",\"1:1\"| CONFIG::CLIENT::MAPPINGS_data,\"4:4\",\"2:2\"| CONFIG::CLIENT::MAPPINGS_data,\"5:5\",\"3:3\"| CONFIG::CLIENT::MAPPINGS_data,\"6:6\",\"3:3\"| CONFIG::CLIENT::MAPPINGS_data,\"7:7\",\"3:3\"| CONFIG::CLIENT::MAPPINGS_data,\"8:8\",\"4:4\"| CONFIG::CLIENT::MAPPINGS_data,\"9:9\",\"5:5\"|CONFIG::CLIENT::MAPPINGS_data,\"24:3D70\":\"10:10\",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,\"25:3H65\":\"11:11\",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,\"26:3J67\":\"12:12\",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,\"27:3K68\":\"13:13\",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,\"28:3K69\":\"14:14\",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,\"29:3K70\":\"15:15\",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"30:3K71":"16:16",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"31:3K72":"17:17",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"32:3K73":"18:18",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"33:3K74":"19:19",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"34:3K75":"20:20",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"35:3K76":"21:21",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"36:3K77":"22:22",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"37:3K78":"23:23",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"38:3K79":"24:24",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"39:3K80":"25:25",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"40:3K81":"26:26",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"41:3K82":"27:27",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"42:3K83":"28:28",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"43:3K84":"29:29",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"44:3K85":"30:30",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"45:3K86":"31:31",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"46:3K87":"32:32",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"47:3K88":"33:33",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"48:3K89":"34:34",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"49:3K90":"35:35",${EMPTY}
    Trigger Lambda Function    ${config_data_lambda_func}    ETL_list=ETL::CLIENTCONFIG
    Verify That Redis Keys Are Correct    CONFIG::CLIENT::MAPPINGS|ETL::CLIENTCONFIG|CONFIG::CLIENT::LASTMODIFIED
    Verify Redis List Data    ETL::CLIENTCONFIG,COMPLETE
    Verify Redis Hash Data    CONFIG::CLIENT::MAPPINGS
    Verify Redis String Data    CONFIG::CLIENT::LASTMODIFIED    pattern=${current_date_data}
    Send GET Request For Admin Clients
    Verify That Correct Client Data Is Returned    [{'clientTopGUID': '0:0', 'clientTopName': 'ClientTop-test-0-0', 'subunits': [{'clientSubGUID': '14:3B67', 'clientSubName': 'CSU-Test_0-1', 'country': {'countryCode': 'US'}}, {'clientSubGUID': '15:3C68', 'clientSubName': 'CSU-Test_0-2', 'country': {'countryCode': 'US'}}, {'clientSubGUID': '16:3D69', 'clientSubName': 'CSU-Test_0-3', 'country': {'countryCode': 'US'}}]}, {'clientTopGUID': '1:1', 'clientTopName': 'ClientTop-test-1-1', 'subunits': [{'clientSubGUID': '17:3E61', 'clientSubName': 'CSU-Test_1-1', 'country': {'countryCode': 'US'}}]}, {'clientTopGUID': '2:2', 'clientTopName': 'ClientTop-test-2-2', 'subunits': [{'clientSubGUID': '18:3F62', 'clientSubName': 'CSU-Test_2-1', 'country': {'countryCode': 'US'}}]}, {'clientTopGUID': '3:3', 'clientTopName': 'ClientTop-test-3-3', 'subunits': [{'clientSubGUID': '19:3G63', 'clientSubName': 'CSU-Test_3-1', 'country': {'countryCode': 'US'}}, {'clientSubGUID': '20:3H64', 'clientSubName': 'CSU-Test_3-2', 'country': {'countryCode': 'US'}}, {'clientSubGUID': '21:3I65', 'clientSubName': 'CSU-Test_3-3', 'country': {'countryCode': 'US'}}]}, {'clientTopGUID': '4:4', 'clientTopName': 'ClientTop-test-4-4', 'subunits': [{'clientSubGUID': '22:3J66', 'clientSubName': 'CSU-Test_4-1', 'country': {'countryCode': 'US'}}]}, {'clientTopGUID': '5:5', 'clientTopName': 'ClientTop-test-5-5', 'subunits': [{'clientSubGUID': '23:3K67', 'clientSubName': 'CSU-Test_5-1', 'country': {'countryCode': 'US'}}]}]

FNC_005 Verify The Error Response For Wiremock Powerbase API (ClientTopUnits/ClientSubUnits)
    Get Current Time With Pattern
    Flush All Redis Keys
    Delete Clients Collecton In MongoDB
    Create Success Stub For Powerbase API    request={"urlPattern":"${wiremock_pb_url}${pb_uri_oauth}.+","method":"POST"}    response=${pb_oauth_response}
    # Error 400 Bad Request
    Create Error Stub For Endpoints For Client Config    400    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "1"}},"method":"GET"}
    Trigger Lambda Function    ${config_data_lambda_func}
    Verify Redis List Data    ETL::CLIENTCONFIG,FAILED
    Send GET Request For Admin Clients
    Verify That Correct Status Code Are Returned    204
    # Error 404 Request Not Found
    Flush All Redis Keys
    Create Error Stub For Endpoints For Client Config    404    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "1"}},"method":"GET"}
    Trigger Lambda Function    ${config_data_lambda_func}
    Verify Redis List Data    ETL::CLIENTCONFIG,FAILED
    Send GET Request For Admin Clients
    Verify That Correct Status Code Are Returned    204
    # Error 500 Request Internal Server Error
    Flush All Redis Keys
    Create Error Stub For Endpoints For Client Config    500    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "1"}},"method":"GET"}
    Trigger Lambda Function    ${config_data_lambda_func}
    Verify Redis List Data    ETL::CLIENTCONFIG,FAILED
    Send GET Request For Admin Clients
    Verify That Correct Status Code Are Returned    204
    # Error 504 Gateway Timeout Error
    Flush All Redis Keys
    Create Error Stub For Endpoints For Client Config    504    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "1"}},"method":"GET"}
    Trigger Lambda Function    ${config_data_lambda_func}
    Verify Redis List Data    ETL::CLIENTCONFIG,FAILED
    Send GET Request For Admin Clients
    Verify That Correct Status Code Are Returned    204

FNC_006 Verify That Client Config Lambda With Powerbase API Is Triggered When StartTimestamp Is Specified In Payload
    Get Current Time With Pattern
    Flush All Redis Keys
    Delete Clients Collecton In MongoDB
    Update Last Modified Date In Redis    last_modified_date=2000-01-01 00:00:00.000
    Create Success Stub For Powerbase API    request={"urlPattern":"${wiremock_pb_url}${pb_uri_oauth}.+","method":"POST"}    response=${pb_oauth_response}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "1"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-0-0","ClientTopUnitGuid":"0:0","ClientSubUnitName":"CSU-Test_0-0","ClientSubUnitGuid":"14:3B67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-1-1","ClientTopUnitGuid":"1:1","ClientSubUnitName":"CSU-Test_1-1","ClientSubUnitGuid":"15:3C68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-2-2","ClientTopUnitGuid":"2:2","ClientSubUnitName":"CSU-Test_2-2","ClientSubUnitGuid":"16:3D69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-3-3","ClientTopUnitGuid":"3:3","ClientSubUnitName":"CSU-Test_3-3","ClientSubUnitGuid":"17:3E61","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-4-4","ClientTopUnitGuid":"4:4","ClientSubUnitName":"CSU-Test_4-4","ClientSubUnitGuid":"18:3F62","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-5-5","ClientTopUnitGuid":"5:5","ClientSubUnitName":"CSU-Test_5-5","ClientSubUnitGuid":"19:3G63","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-6-6","ClientTopUnitGuid":"6:6","ClientSubUnitName":"CSU-Test_6-6","ClientSubUnitGuid":"20:3H64","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-7-7","ClientTopUnitGuid":"7:7","ClientSubUnitName":"CSU-Test_7-7","ClientSubUnitGuid":"21:3I65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-8-8","ClientTopUnitGuid":"8:8","ClientSubUnitName":"CSU-Test_8-8","ClientSubUnitGuid":"22:3J66","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-9-9","ClientTopUnitGuid":"9:9","ClientSubUnitName":"CSU-Test_9-9","ClientSubUnitGuid":"23:3K67","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "3"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-10-10","ClientTopUnitGuid":"10:10","ClientSubUnitName":"CSU-Test_10-10","ClientSubUnitGuid":"24:3D70","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-11-11","ClientTopUnitGuid":"11:11","ClientSubUnitName":"CSU-Test_11-11","ClientSubUnitGuid":"25:3H65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-12-12","ClientTopUnitGuid":"12:12","ClientSubUnitName":"CSU-Test_12-12","ClientSubUnitGuid":"26:3J67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-13-13","ClientTopUnitGuid":"13:13","ClientSubUnitName":"CSU-Test_13-13","ClientSubUnitGuid":"27:3K68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-14-14","ClientTopUnitGuid":"14:14","ClientSubUnitName":"CSU-Test_14-14","ClientSubUnitGuid":"28:3K69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-15-15","ClientTopUnitGuid":"15:15","ClientSubUnitName":"CSU-Test_15-15","ClientSubUnitGuid":"29:3K70","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "1"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-16-16","ClientTopUnitGuid":"16:16","ClientSubUnitName":"CSU-Test_16-16","ClientSubUnitGuid":"30:3K71","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-17-17","ClientTopUnitGuid":"17:17","ClientSubUnitName":"CSU-Test_17-17","ClientSubUnitGuid":"31:3K72","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-18-18","ClientTopUnitGuid":"18:18","ClientSubUnitName":"CSU-Test_18-18","ClientSubUnitGuid":"32:3K73","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-19-19","ClientTopUnitGuid":"19:19","ClientSubUnitName":"CSU-Test_19-19","ClientSubUnitGuid":"33:3K74","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-20-20","ClientTopUnitGuid":"20:20","ClientSubUnitName":"CSU-Test_20-20","ClientSubUnitGuid":"34:3K75","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-21-21","ClientTopUnitGuid":"21:21","ClientSubUnitName":"CSU-Test_21-21","ClientSubUnitGuid":"35:3K76","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-22-22","ClientTopUnitGuid":"22:22","ClientSubUnitName":"CSU-Test_22-22","ClientSubUnitGuid":"36:3K77","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-23-23","ClientTopUnitGuid":"23:23","ClientSubUnitName":"CSU-Test_23-23","ClientSubUnitGuid":"37:3K78","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-24-24","ClientTopUnitGuid":"24:24","ClientSubUnitName":"CSU-Test_24-24","ClientSubUnitGuid":"38:3K79","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-25-25","ClientTopUnitGuid":"25:25","ClientSubUnitName":"CSU-Test_25-25","ClientSubUnitGuid":"39:3K80","CountryCode":"US"}]}
    Create Error Stub For Endpoints For Client Config    204    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "4"}},"method":"GET"}    response={"Code":202,"Error":"NO_DATA_FOUND","Description":"request did not yield any result"}
    Replace Strings In Variables    CONFIG::CLIENT::MAPPINGS_data,"30:3K71":"16:16",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"31:3K72":"17:17",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"32:3K73":"18:18",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"33:3K74":"19:19",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"34:3K75":"20:20",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"35:3K76":"21:21",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"36:3K77":"22:22",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"37:3K78":"23:23",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"38:3K79":"24:24",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"39:3K80":"25:25",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"40:3K81":"26:26",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"41:3K82":"27:27",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"42:3K83":"28:28",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"43:3K84":"29:29",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"44:3K85":"30:30",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"45:3K86":"31:31",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"46:3K87":"32:32",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"47:3K88":"33:33",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"48:3K89":"34:34",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"49:3K90":"35:35",${EMPTY}
    Trigger Lambda Function With Payload    ${config_data_lambda_func}    payload="{\\\"startTimestamp\\\":\\\"2018-01-01 00:00:00.000\\\"}"
    Verify That Redis Keys Are Correct    CONFIG::CLIENT::MAPPINGS|ETL::CLIENTCONFIG|CONFIG::CLIENT::LASTMODIFIED
    Verify Redis Hash Data    CONFIG::CLIENT::MAPPINGS
    Verify Redis List Data    ETL::CLIENTCONFIG,COMPLETE
    Verify Redis String Data    CONFIG::CLIENT::LASTMODIFIED    pattern=${current_date_data}
    Send GET Request For Admin Clients
    Verify That Correct Client Data Is Returned    [{'clientTopGUID': '2:2', 'clientTopName': 'ClientTop-test-2-2', 'subunits': [{'clientSubGUID': '16:3D69', 'clientSubName': 'CSU-Test_2-2', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '7:7', 'clientTopName': 'ClientTop-test-7-7', 'subunits': [{'clientSubGUID': '21:3I65', 'clientSubName': 'CSU-Test_7-7', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '4:4', 'clientTopName': 'ClientTop-test-4-4', 'subunits': [{'clientSubGUID': '18:3F62', 'clientSubName': 'CSU-Test_4-4', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '9:9', 'clientTopName': 'ClientTop-test-9-9', 'subunits': [{'clientSubGUID': '23:3K67', 'clientSubName': 'CSU-Test_9-9', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '3:3', 'clientTopName': 'ClientTop-test-3-3', 'subunits': [{'clientSubGUID': '17:3E61', 'clientSubName': 'CSU-Test_3-3', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '8:8', 'clientTopName': 'ClientTop-test-8-8', 'subunits': [{'clientSubGUID': '22:3J66', 'clientSubName': 'CSU-Test_8-8', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '1:1', 'clientTopName': 'ClientTop-test-1-1', 'subunits': [{'clientSubGUID': '15:3C68', 'clientSubName': 'CSU-Test_1-1', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '6:6', 'clientTopName': 'ClientTop-test-6-6', 'subunits': [{'clientSubGUID': '20:3H64', 'clientSubName': 'CSU-Test_6-6', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '0:0', 'clientTopName': 'ClientTop-test-0-0', 'subunits': [{'clientSubGUID': '14:3B67', 'clientSubName': 'CSU-Test_0-0', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '5:5', 'clientTopName': 'ClientTop-test-5-5', 'subunits': [{'clientSubGUID': '19:3G63', 'clientSubName': 'CSU-Test_5-5', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '10:10', 'clientTopName': 'ClientTop-test-10-10', 'subunits': [{'clientSubGUID': '24:3D70', 'clientSubName': 'CSU-Test_10-10', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '11:11', 'clientTopName': 'ClientTop-test-11-11', 'subunits': [{'clientSubGUID': '25:3H65', 'clientSubName': 'CSU-Test_11-11', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '12:12', 'clientTopName': 'ClientTop-test-12-12', 'subunits': [{'clientSubGUID': '26:3J67', 'clientSubName': 'CSU-Test_12-12', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '13:13', 'clientTopName': 'ClientTop-test-13-13', 'subunits': [{'clientSubGUID': '27:3K68', 'clientSubName': 'CSU-Test_13-13', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '14:14', 'clientTopName': 'ClientTop-test-14-14', 'subunits': [{'clientSubGUID': '28:3K69', 'clientSubName': 'CSU-Test_14-14', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '15:15', 'clientTopName': 'ClientTop-test-15-15', 'subunits': [{'clientSubGUID': '29:3K70', 'clientSubName': 'CSU-Test_15-15', 'country': {'countryCode': 'US'}}]}]

FNC_007 Verify That Client Config Lambda With Powerbase API Is Triggered When StartTimestamp And EndTimeStamp Is Specified In Payload
    Get Current Time With Pattern
    Flush All Redis Keys
    Delete Clients Collecton In MongoDB
    Update Last Modified Date In Redis    last_modified_date=2000-01-01 00:00:00.000
    Create Success Stub For Powerbase API    request={"urlPattern":"${wiremock_pb_url}${pb_uri_oauth}.+","method":"POST"}    response=${pb_oauth_response}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2019-01-01 00:00:00.000"},"pageNo":{"equalTo": "1"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-0-0","ClientTopUnitGuid":"0:0","ClientSubUnitName":"CSU-Test_0-0","ClientSubUnitGuid":"14:3B67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-1-1","ClientTopUnitGuid":"1:1","ClientSubUnitName":"CSU-Test_1-1","ClientSubUnitGuid":"15:3C68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-2-2","ClientTopUnitGuid":"2:2","ClientSubUnitName":"CSU-Test_2-2","ClientSubUnitGuid":"16:3D69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-3-3","ClientTopUnitGuid":"3:3","ClientSubUnitName":"CSU-Test_3-3","ClientSubUnitGuid":"17:3E61","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-4-4","ClientTopUnitGuid":"4:4","ClientSubUnitName":"CSU-Test_4-4","ClientSubUnitGuid":"18:3F62","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2019-01-01 00:00:00.000"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-5-5","ClientTopUnitGuid":"5:5","ClientSubUnitName":"CSU-Test_5-5","ClientSubUnitGuid":"19:3G63","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-6-6","ClientTopUnitGuid":"6:6","ClientSubUnitName":"CSU-Test_6-6","ClientSubUnitGuid":"20:3H64","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-7-7","ClientTopUnitGuid":"7:7","ClientSubUnitName":"CSU-Test_7-7","ClientSubUnitGuid":"21:3I65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-8-8","ClientTopUnitGuid":"8:8","ClientSubUnitName":"CSU-Test_8-8","ClientSubUnitGuid":"22:3J66","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-9-9","ClientTopUnitGuid":"9:9","ClientSubUnitName":"CSU-Test_9-9","ClientSubUnitGuid":"23:3K67","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2019-01-01 00:00:00.000"},"pageNo":{"equalTo": "3"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-10-10","ClientTopUnitGuid":"10:10","ClientSubUnitName":"CSU-Test_10-10","ClientSubUnitGuid":"24:3D70","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-11-11","ClientTopUnitGuid":"11:11","ClientSubUnitName":"CSU-Test_11-11","ClientSubUnitGuid":"25:3H65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-12-12","ClientTopUnitGuid":"12:12","ClientSubUnitName":"CSU-Test_12-12","ClientSubUnitGuid":"26:3J67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-13-13","ClientTopUnitGuid":"13:13","ClientSubUnitName":"CSU-Test_13-13","ClientSubUnitGuid":"27:3K68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-14-14","ClientTopUnitGuid":"14:14","ClientSubUnitName":"CSU-Test_14-14","ClientSubUnitGuid":"28:3K69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-15-15","ClientTopUnitGuid":"15:15","ClientSubUnitName":"CSU-Test_15-15","ClientSubUnitGuid":"29:3K70","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2000-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2019-01-01 00:00:00.000"},"pageNo":{"equalTo": "1"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-5-5","ClientTopUnitGuid":"5:5","ClientSubUnitName":"CSU-Test_5-5","ClientSubUnitGuid":"19:3G63","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-6-6","ClientTopUnitGuid":"6:6","ClientSubUnitName":"CSU-Test_6-6","ClientSubUnitGuid":"20:3H64","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-7-7","ClientTopUnitGuid":"7:7","ClientSubUnitName":"CSU-Test_7-7","ClientSubUnitGuid":"21:3I65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-8-8","ClientTopUnitGuid":"8:8","ClientSubUnitName":"CSU-Test_8-8","ClientSubUnitGuid":"22:3J66","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-9-9","ClientTopUnitGuid":"9:9","ClientSubUnitName":"CSU-Test_9-9","ClientSubUnitGuid":"23:3K67","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2000-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2019-01-01 00:00:00.000"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-10-10","ClientTopUnitGuid":"10:10","ClientSubUnitName":"CSU-Test_10-10","ClientSubUnitGuid":"24:3D70","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-11-11","ClientTopUnitGuid":"11:11","ClientSubUnitName":"CSU-Test_11-11","ClientSubUnitGuid":"25:3H65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-12-12","ClientTopUnitGuid":"12:12","ClientSubUnitName":"CSU-Test_12-12","ClientSubUnitGuid":"26:3J67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-13-13","ClientTopUnitGuid":"13:13","ClientSubUnitName":"CSU-Test_13-13","ClientSubUnitGuid":"27:3K68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-14-14","ClientTopUnitGuid":"14:14","ClientSubUnitName":"CSU-Test_14-14","ClientSubUnitGuid":"28:3K69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-15-15","ClientTopUnitGuid":"15:15","ClientSubUnitName":"CSU-Test_15-15","ClientSubUnitGuid":"29:3K70","CountryCode":"US"}]}
    Create Error Stub For Endpoints For Client Config    204    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2019-01-01 00:00:00.000"},"pageNo":{"equalTo": "4"}},"method":"GET"}    response={"Code":202,"Error":"NO_DATA_FOUND","Description":"request did not yield any result"}
    Replace Strings In Variables    CONFIG::CLIENT::MAPPINGS_data,"30:3K71":"16:16",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"31:3K72":"17:17",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"32:3K73":"18:18",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"33:3K74":"19:19",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"34:3K75":"20:20",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"35:3K76":"21:21",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"36:3K77":"22:22",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"37:3K78":"23:23",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"38:3K79":"24:24",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"39:3K80":"25:25",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"40:3K81":"26:26",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"41:3K82":"27:27",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"42:3K83":"28:28",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"43:3K84":"29:29",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"44:3K85":"30:30",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"45:3K86":"31:31",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"46:3K87":"32:32",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"47:3K88":"33:33",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"48:3K89":"34:34",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"49:3K90":"35:35",${EMPTY}
    Trigger Lambda Function With Payload    ${config_data_lambda_func}    payload="{\\\"startTimestamp\\\":\\\"1970-01-01 00:00:00.000\\\",\\\"endTimestamp\\\":\\\"2019-01-01 00:00:00.000\\\"}"
    Verify That Redis Keys Are Correct    CONFIG::CLIENT::MAPPINGS|ETL::CLIENTCONFIG|CONFIG::CLIENT::LASTMODIFIED
    Verify Redis Hash Data    CONFIG::CLIENT::MAPPINGS
    Verify Redis List Data    ETL::CLIENTCONFIG,COMPLETE
    Verify Redis String Data    CONFIG::CLIENT::LASTMODIFIED    pattern=2019-01-01 00:00:00.000
    Send GET Request For Admin Clients
    Verify That Correct Client Data Is Returned    [{'clientTopGUID': '2:2', 'clientTopName': 'ClientTop-test-2-2', 'subunits': [{'clientSubGUID': '16:3D69', 'clientSubName': 'CSU-Test_2-2', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '7:7', 'clientTopName': 'ClientTop-test-7-7', 'subunits': [{'clientSubGUID': '21:3I65', 'clientSubName': 'CSU-Test_7-7', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '4:4', 'clientTopName': 'ClientTop-test-4-4', 'subunits': [{'clientSubGUID': '18:3F62', 'clientSubName': 'CSU-Test_4-4', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '9:9', 'clientTopName': 'ClientTop-test-9-9', 'subunits': [{'clientSubGUID': '23:3K67', 'clientSubName': 'CSU-Test_9-9', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '3:3', 'clientTopName': 'ClientTop-test-3-3', 'subunits': [{'clientSubGUID': '17:3E61', 'clientSubName': 'CSU-Test_3-3', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '8:8', 'clientTopName': 'ClientTop-test-8-8', 'subunits': [{'clientSubGUID': '22:3J66', 'clientSubName': 'CSU-Test_8-8', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '1:1', 'clientTopName': 'ClientTop-test-1-1', 'subunits': [{'clientSubGUID': '15:3C68', 'clientSubName': 'CSU-Test_1-1', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '6:6', 'clientTopName': 'ClientTop-test-6-6', 'subunits': [{'clientSubGUID': '20:3H64', 'clientSubName': 'CSU-Test_6-6', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '0:0', 'clientTopName': 'ClientTop-test-0-0', 'subunits': [{'clientSubGUID': '14:3B67', 'clientSubName': 'CSU-Test_0-0', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '5:5', 'clientTopName': 'ClientTop-test-5-5', 'subunits': [{'clientSubGUID': '19:3G63', 'clientSubName': 'CSU-Test_5-5', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '10:10', 'clientTopName': 'ClientTop-test-10-10', 'subunits': [{'clientSubGUID': '24:3D70', 'clientSubName': 'CSU-Test_10-10', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '11:11', 'clientTopName': 'ClientTop-test-11-11', 'subunits': [{'clientSubGUID': '25:3H65', 'clientSubName': 'CSU-Test_11-11', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '12:12', 'clientTopName': 'ClientTop-test-12-12', 'subunits': [{'clientSubGUID': '26:3J67', 'clientSubName': 'CSU-Test_12-12', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '13:13', 'clientTopName': 'ClientTop-test-13-13', 'subunits': [{'clientSubGUID': '27:3K68', 'clientSubName': 'CSU-Test_13-13', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '14:14', 'clientTopName': 'ClientTop-test-14-14', 'subunits': [{'clientSubGUID': '28:3K69', 'clientSubName': 'CSU-Test_14-14', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '15:15', 'clientTopName': 'ClientTop-test-15-15', 'subunits': [{'clientSubGUID': '29:3K70', 'clientSubName': 'CSU-Test_15-15', 'country': {'countryCode': 'US'}}]}]

FNC_008 Verify That Client Config Lambda With Powerbase API Is Triggered When StartTimestamp, EndTimeStamp And PageNo Is Specified In Payload
    Get Current Time With Pattern
    Flush All Redis Keys
    Delete Clients Collecton In MongoDB
    Create Success Stub For Powerbase API    request={"urlPattern":"${wiremock_pb_url}${pb_uri_oauth}.+","method":"POST"}    response=${pb_oauth_response}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2019-01-01 00:00:00.000"},"pageNo":{"equalTo": "1"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-0-0","ClientTopUnitGuid":"0:0","ClientSubUnitName":"CSU-Test_0-0","ClientSubUnitGuid":"14:3B67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-1-1","ClientTopUnitGuid":"1:1","ClientSubUnitName":"CSU-Test_1-1","ClientSubUnitGuid":"15:3C68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-2-2","ClientTopUnitGuid":"2:2","ClientSubUnitName":"CSU-Test_2-2","ClientSubUnitGuid":"16:3D69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-3-3","ClientTopUnitGuid":"3:3","ClientSubUnitName":"CSU-Test_3-3","ClientSubUnitGuid":"17:3E61","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-4-4","ClientTopUnitGuid":"4:4","ClientSubUnitName":"CSU-Test_4-4","ClientSubUnitGuid":"18:3F62","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2019-01-01 00:00:00.000"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-5-5","ClientTopUnitGuid":"5:5","ClientSubUnitName":"CSU-Test_5-5","ClientSubUnitGuid":"19:3G63","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-6-6","ClientTopUnitGuid":"6:6","ClientSubUnitName":"CSU-Test_6-6","ClientSubUnitGuid":"20:3H64","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-7-7","ClientTopUnitGuid":"7:7","ClientSubUnitName":"CSU-Test_7-7","ClientSubUnitGuid":"21:3I65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-8-8","ClientTopUnitGuid":"8:8","ClientSubUnitName":"CSU-Test_8-8","ClientSubUnitGuid":"22:3J66","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-9-9","ClientTopUnitGuid":"9:9","ClientSubUnitName":"CSU-Test_9-9","ClientSubUnitGuid":"23:3K67","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2019-01-01 00:00:00.000"},"pageNo":{"equalTo": "3"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-10-10","ClientTopUnitGuid":"10:10","ClientSubUnitName":"CSU-Test_10-10","ClientSubUnitGuid":"24:3D70","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-11-11","ClientTopUnitGuid":"11:11","ClientSubUnitName":"CSU-Test_11-11","ClientSubUnitGuid":"25:3H65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-12-12","ClientTopUnitGuid":"12:12","ClientSubUnitName":"CSU-Test_12-12","ClientSubUnitGuid":"26:3J67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-13-13","ClientTopUnitGuid":"13:13","ClientSubUnitName":"CSU-Test_13-13","ClientSubUnitGuid":"27:3K68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-14-14","ClientTopUnitGuid":"14:14","ClientSubUnitName":"CSU-Test_14-14","ClientSubUnitGuid":"28:3K69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-15-15","ClientTopUnitGuid":"15:15","ClientSubUnitName":"CSU-Test_15-15","ClientSubUnitGuid":"29:3K70","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2019-01-01 00:00:00.000"},"pageNo":{"equalTo": "4"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-16-16","ClientTopUnitGuid":"16:16","ClientSubUnitName":"CSU-Test_16-16","ClientSubUnitGuid":"30:3K71","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-17-17","ClientTopUnitGuid":"17:17","ClientSubUnitName":"CSU-Test_17-17","ClientSubUnitGuid":"31:3K72","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-18-18","ClientTopUnitGuid":"18:18","ClientSubUnitName":"CSU-Test_18-18","ClientSubUnitGuid":"32:3K73","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-19-19","ClientTopUnitGuid":"19:19","ClientSubUnitName":"CSU-Test_19-19","ClientSubUnitGuid":"33:3K74","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-20-20","ClientTopUnitGuid":"20:20","ClientSubUnitName":"CSU-Test_20-20","ClientSubUnitGuid":"34:3K75","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2019-01-01 00:00:00.000"},"pageNo":{"equalTo": "5"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-21-21","ClientTopUnitGuid":"21:21","ClientSubUnitName":"CSU-Test_21-21","ClientSubUnitGuid":"35:3K76","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-22-22","ClientTopUnitGuid":"22:22","ClientSubUnitName":"CSU-Test_22-22","ClientSubUnitGuid":"36:3K77","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-23-23","ClientTopUnitGuid":"23:23","ClientSubUnitName":"CSU-Test_23-23","ClientSubUnitGuid":"37:3K78","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-24-24","ClientTopUnitGuid":"24:24","ClientSubUnitName":"CSU-Test_24-24","ClientSubUnitGuid":"38:3K79","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-25-25","ClientTopUnitGuid":"25:25","ClientSubUnitName":"CSU-Test_25-25","ClientSubUnitGuid":"39:3K80","CountryCode":"US"}]}
    Create Error Stub For Endpoints For Client Config    204    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2019-01-01 00:00:00.000"},"pageNo":{"equalTo": "6"}},"method":"GET"}    response={"Code":202,"Error":"NO_DATA_FOUND","Description":"request did not yield any result"}
    Replace Strings In Variables    CONFIG::CLIENT::MAPPINGS_data,"14:3B67":"0:0",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"15:3C68":"1:1",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"16:3D69":"2:2",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"17:3E61":"3:3",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"18:3F62":"4:4",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"19:3G63":"5:5",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"20:3H64":"6:6",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"21:3I65":"7:7",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"22:3J66":"8:8",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"23:3K67":"9:9",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"40:3K81":"26:26",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"41:3K82":"27:27",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"42:3K83":"28:28",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"43:3K84":"29:29",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"44:3K85":"30:30",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"45:3K86":"31:31",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"46:3K87":"32:32",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"47:3K88":"33:33",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"48:3K89":"34:34",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"49:3K90":"35:35",${EMPTY}
    Trigger Lambda Function With Payload    ${config_data_lambda_func}    payload="{\\\"startTimestamp\\\":\\\"1970-01-01 00:00:00.000\\\",\\\"endTimestamp\\\":\\\"2019-01-01 00:00:00.000\\\",\\\"startPage\\\":3}"
    Verify That Redis Keys Are Correct    CONFIG::CLIENT::MAPPINGS|ETL::CLIENTCONFIG|CONFIG::CLIENT::LASTMODIFIED
    Verify Redis Hash Data    CONFIG::CLIENT::MAPPINGS
    Verify Redis List Data    ETL::CLIENTCONFIG,COMPLETE
    Verify Redis String Data    CONFIG::CLIENT::LASTMODIFIED    pattern=2019-01-01 00:00:00.000
    Send GET Request For Admin Clients
    Verify That Correct Client Data Is Returned    [{'clientTopGUID': '10:10', 'clientTopName': 'ClientTop-test-10-10', 'subunits': [{'clientSubGUID': '24:3D70', 'clientSubName': 'CSU-Test_10-10', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '11:11', 'clientTopName': 'ClientTop-test-11-11', 'subunits': [{'clientSubGUID': '25:3H65', 'clientSubName': 'CSU-Test_11-11', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '12:12', 'clientTopName': 'ClientTop-test-12-12', 'subunits': [{'clientSubGUID': '26:3J67', 'clientSubName': 'CSU-Test_12-12', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '13:13', 'clientTopName': 'ClientTop-test-13-13', 'subunits': [{'clientSubGUID': '27:3K68', 'clientSubName': 'CSU-Test_13-13', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '14:14', 'clientTopName': 'ClientTop-test-14-14', 'subunits': [{'clientSubGUID': '28:3K69', 'clientSubName': 'CSU-Test_14-14', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '15:15', 'clientTopName': 'ClientTop-test-15-15', 'subunits': [{'clientSubGUID': '29:3K70', 'clientSubName': 'CSU-Test_15-15', 'country': {'countryCode': 'US'}}]}{'clientTopGUID': '16:16', 'clientTopName': 'ClientTop-test-16-16', 'subunits': [{'clientSubGUID': '30:3K71', 'clientSubName': 'CSU-Test_16-16', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '17:17', 'clientTopName': 'ClientTop-test-17-17', 'subunits': [{'clientSubGUID': '31:3K72', 'clientSubName': 'CSU-Test_17-17', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '18:18', 'clientTopName': 'ClientTop-test-18-18', 'subunits': [{'clientSubGUID': '32:3K73', 'clientSubName': 'CSU-Test_18-18', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '19:19', 'clientTopName': 'ClientTop-test-19-19', 'subunits': [{'clientSubGUID': '33:3K74', 'clientSubName': 'CSU-Test_19-19', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '20:20', 'clientTopName': 'ClientTop-test-20-20', 'subunits': [{'clientSubGUID': '34:3K75', 'clientSubName': 'CSU-Test_20-20', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '21:21', 'clientTopName': 'ClientTop-test-21-21', 'subunits': [{'clientSubGUID': '35:3K76', 'clientSubName': 'CSU-Test_21-21', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '22:22', 'clientTopName': 'ClientTop-test-22-22', 'subunits': [{'clientSubGUID': '36:3K77', 'clientSubName': 'CSU-Test_22-22', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '23:23', 'clientTopName': 'ClientTop-test-23-23', 'subunits': [{'clientSubGUID': '37:3K78', 'clientSubName': 'CSU-Test_23-23', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '24:24', 'clientTopName': 'ClientTop-test-24-24', 'subunits': [{'clientSubGUID': '38:3K79', 'clientSubName': 'CSU-Test_24-24', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '25:25', 'clientTopName': 'ClientTop-test-25-25', 'subunits': [{'clientSubGUID': '39:3K80', 'clientSubName': 'CSU-Test_25-25', 'country': {'countryCode': 'US'}}]}]

FNC_009 Verify That Client Config Lambda With Powerbase API Is Triggered When Lambda StartTimestamp, EndTimeStamp, startPage And endPage Is Specified In Payload
    Get Current Time With Pattern
    Flush All Redis Keys
    Delete Clients Collecton In MongoDB
    Create Success Stub For Powerbase API    request={"urlPattern":"${wiremock_pb_url}${pb_uri_oauth}.+","method":"POST"}    response=${pb_oauth_response}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"pageNo":{"equalTo": "1"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-0-0","ClientTopUnitGuid":"0:0","ClientSubUnitName":"CSU-Test_0-0","ClientSubUnitGuid":"14:3B67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-1-1","ClientTopUnitGuid":"1:1","ClientSubUnitName":"CSU-Test_1-1","ClientSubUnitGuid":"15:3C68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-2-2","ClientTopUnitGuid":"2:2","ClientSubUnitName":"CSU-Test_2-2","ClientSubUnitGuid":"16:3D69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-3-3","ClientTopUnitGuid":"3:3","ClientSubUnitName":"CSU-Test_3-3","ClientSubUnitGuid":"17:3E61","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-4-4","ClientTopUnitGuid":"4:4","ClientSubUnitName":"CSU-Test_4-4","ClientSubUnitGuid":"18:3F62","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-5-5","ClientTopUnitGuid":"5:5","ClientSubUnitName":"CSU-Test_5-5","ClientSubUnitGuid":"19:3G63","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-6-6","ClientTopUnitGuid":"6:6","ClientSubUnitName":"CSU-Test_6-6","ClientSubUnitGuid":"20:3H64","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-7-7","ClientTopUnitGuid":"7:7","ClientSubUnitName":"CSU-Test_7-7","ClientSubUnitGuid":"21:3I65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-8-8","ClientTopUnitGuid":"8:8","ClientSubUnitName":"CSU-Test_8-8","ClientSubUnitGuid":"22:3J66","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-9-9","ClientTopUnitGuid":"9:9","ClientSubUnitName":"CSU-Test_9-9","ClientSubUnitGuid":"23:3K67","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"pageNo":{"equalTo": "3"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-10-10","ClientTopUnitGuid":"10:10","ClientSubUnitName":"CSU-Test_10-10","ClientSubUnitGuid":"24:3D70","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-11-11","ClientTopUnitGuid":"11:11","ClientSubUnitName":"CSU-Test_11-11","ClientSubUnitGuid":"25:3H65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-12-12","ClientTopUnitGuid":"12:12","ClientSubUnitName":"CSU-Test_12-12","ClientSubUnitGuid":"26:3J67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-13-13","ClientTopUnitGuid":"13:13","ClientSubUnitName":"CSU-Test_13-13","ClientSubUnitGuid":"27:3K68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-14-14","ClientTopUnitGuid":"14:14","ClientSubUnitName":"CSU-Test_14-14","ClientSubUnitGuid":"28:3K69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-15-15","ClientTopUnitGuid":"15:15","ClientSubUnitName":"CSU-Test_15-15","ClientSubUnitGuid":"29:3K70","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"pageNo":{"equalTo": "4"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-16-16","ClientTopUnitGuid":"16:16","ClientSubUnitName":"CSU-Test_16-16","ClientSubUnitGuid":"30:3K71","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-17-17","ClientTopUnitGuid":"17:17","ClientSubUnitName":"CSU-Test_17-17","ClientSubUnitGuid":"31:3K72","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-18-18","ClientTopUnitGuid":"18:18","ClientSubUnitName":"CSU-Test_18-18","ClientSubUnitGuid":"32:3K73","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-19-19","ClientTopUnitGuid":"19:19","ClientSubUnitName":"CSU-Test_19-19","ClientSubUnitGuid":"33:3K74","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-20-20","ClientTopUnitGuid":"20:20","ClientSubUnitName":"CSU-Test_20-20","ClientSubUnitGuid":"34:3K75","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"pageNo":{"equalTo": "5"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-21-21","ClientTopUnitGuid":"21:21","ClientSubUnitName":"CSU-Test_21-21","ClientSubUnitGuid":"35:3K76","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-22-22","ClientTopUnitGuid":"22:22","ClientSubUnitName":"CSU-Test_22-22","ClientSubUnitGuid":"36:3K77","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-23-23","ClientTopUnitGuid":"23:23","ClientSubUnitName":"CSU-Test_23-23","ClientSubUnitGuid":"37:3K78","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-24-24","ClientTopUnitGuid":"24:24","ClientSubUnitName":"CSU-Test_24-24","ClientSubUnitGuid":"38:3K79","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-25-25","ClientTopUnitGuid":"25:25","ClientSubUnitName":"CSU-Test_25-25","ClientSubUnitGuid":"39:3K80","CountryCode":"US"}]}
    Create Error Stub For Endpoints For Client Config    204    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"pageNo":{"equalTo": "6"}},"method":"GET"}    response={"Code":202,"Error":"NO_DATA_FOUND","Description":"request did not yield any result"}
    Replace Strings In Variables    CONFIG::CLIENT::MAPPINGS_data,"14:3B67":"0:0",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"15:3C68":"1:1",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"16:3D69":"2:2",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"17:3E61":"3:3",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"18:3F62":"4:4",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"19:3G63":"5:5",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"20:3H64":"6:6",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"21:3I65":"7:7",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"22:3J66":"8:8",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"23:3K67":"9:9",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"35:3K76":"21:21",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"36:3K77":"22:22",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"37:3K78":"23:23",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"38:3K79":"24:24",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"39:3K80":"25:25",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"40:3K81":"26:26",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"41:3K82":"27:27",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"42:3K83":"28:28",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"43:3K84":"29:29",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"44:3K85":"30:30",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"45:3K86":"31:31",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"46:3K87":"32:32",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"47:3K88":"33:33",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"48:3K89":"34:34",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"49:3K90":"35:35",${EMPTY}
    Trigger Lambda Function With Payload    ${config_data_lambda_func}    payload="{\\\"startTimestamp\\\":\\\"1970-01-01 00:00:00.000\\\",\\\"endTimestamp\\\":\\\"2018-01-01 00:00:00.000\\\",\\\"startPage\\\":3,\\\"endPage\\\":4}"
    Verify That Redis Keys Are Correct    CONFIG::CLIENT::MAPPINGS|ETL::CLIENTCONFIG|CONFIG::CLIENT::LASTMODIFIED
    Verify Redis Hash Data    CONFIG::CLIENT::MAPPINGS
    Verify Redis List Data    ETL::CLIENTCONFIG,COMPLETE
    Verify Redis String Data    CONFIG::CLIENT::LASTMODIFIED    pattern=2018-01-01 00:00:00.000
    Send GET Request For Admin Clients
    Verify That Correct Client Data Is Returned    [{'clientTopGUID': '10:10', 'clientTopName': 'ClientTop-test-10-10', 'subunits': [{'clientSubGUID': '24:3D70', 'clientSubName': 'CSU-Test_10-10', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '11:11', 'clientTopName': 'ClientTop-test-11-11', 'subunits': [{'clientSubGUID': '25:3H65', 'clientSubName': 'CSU-Test_11-11', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '12:12', 'clientTopName': 'ClientTop-test-12-12', 'subunits': [{'clientSubGUID': '26:3J67', 'clientSubName': 'CSU-Test_12-12', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '13:13', 'clientTopName': 'ClientTop-test-13-13', 'subunits': [{'clientSubGUID': '27:3K68', 'clientSubName': 'CSU-Test_13-13', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '14:14', 'clientTopName': 'ClientTop-test-14-14', 'subunits': [{'clientSubGUID': '28:3K69', 'clientSubName': 'CSU-Test_14-14', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '15:15', 'clientTopName': 'ClientTop-test-15-15', 'subunits': [{'clientSubGUID': '29:3K70', 'clientSubName': 'CSU-Test_15-15', 'country': {'countryCode': 'US'}}]}{'clientTopGUID': '16:16', 'clientTopName': 'ClientTop-test-16-16', 'subunits': [{'clientSubGUID': '30:3K71', 'clientSubName': 'CSU-Test_16-16', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '17:17', 'clientTopName': 'ClientTop-test-17-17', 'subunits': [{'clientSubGUID': '31:3K72', 'clientSubName': 'CSU-Test_17-17', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '18:18', 'clientTopName': 'ClientTop-test-18-18', 'subunits': [{'clientSubGUID': '32:3K73', 'clientSubName': 'CSU-Test_18-18', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '19:19', 'clientTopName': 'ClientTop-test-19-19', 'subunits': [{'clientSubGUID': '33:3K74', 'clientSubName': 'CSU-Test_19-19', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '20:20', 'clientTopName': 'ClientTop-test-20-20', 'subunits': [{'clientSubGUID': '34:3K75', 'clientSubName': 'CSU-Test_20-20', 'country': {'countryCode': 'US'}}]}]

FNC_010 Verify That Client Config Lambda With Powerbase API Is Triggered When EndTimestamp And startPage Is Specified In Payload
    Get Current Time With Pattern
    Flush All Redis Keys
    Delete Clients Collecton In MongoDB
    Update Last Modified Date In Redis    last_modified_date=2000-01-01 00:00:00.000
    Create Success Stub For Powerbase API    request={"urlPattern":"${wiremock_pb_url}${pb_uri_oauth}.+","method":"POST"}    response=${pb_oauth_response}
    Create Success Stub For Powerbase API    request={"urlPattern":"${wiremock_pb_url}${pb_uri_csu_updates}\\\\?StartTimestamp=.+&EndTimestamp=2018-01-01\\\\+00%3A00%3A00.000&pageNo=1","method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-0-0","ClientTopUnitGuid":"0:0","ClientSubUnitName":"CSU-Test_0-0","ClientSubUnitGuid":"14:3B67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-1-1","ClientTopUnitGuid":"1:1","ClientSubUnitName":"CSU-Test_1-1","ClientSubUnitGuid":"15:3C68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-2-2","ClientTopUnitGuid":"2:2","ClientSubUnitName":"CSU-Test_2-2","ClientSubUnitGuid":"16:3D69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-3-3","ClientTopUnitGuid":"3:3","ClientSubUnitName":"CSU-Test_3-3","ClientSubUnitGuid":"17:3E61","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-4-4","ClientTopUnitGuid":"4:4","ClientSubUnitName":"CSU-Test_4-4","ClientSubUnitGuid":"18:3F62","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-5-5","ClientTopUnitGuid":"5:5","ClientSubUnitName":"CSU-Test_5-5","ClientSubUnitGuid":"19:3G63","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-6-6","ClientTopUnitGuid":"6:6","ClientSubUnitName":"CSU-Test_6-6","ClientSubUnitGuid":"20:3H64","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-7-7","ClientTopUnitGuid":"7:7","ClientSubUnitName":"CSU-Test_7-7","ClientSubUnitGuid":"21:3I65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-8-8","ClientTopUnitGuid":"8:8","ClientSubUnitName":"CSU-Test_8-8","ClientSubUnitGuid":"22:3J66","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-9-9","ClientTopUnitGuid":"9:9","ClientSubUnitName":"CSU-Test_9-9","ClientSubUnitGuid":"23:3K67","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"pageNo":{"equalTo": "3"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-10-10","ClientTopUnitGuid":"10:10","ClientSubUnitName":"CSU-Test_10-10","ClientSubUnitGuid":"24:3D70","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-11-11","ClientTopUnitGuid":"11:11","ClientSubUnitName":"CSU-Test_11-11","ClientSubUnitGuid":"25:3H65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-12-12","ClientTopUnitGuid":"12:12","ClientSubUnitName":"CSU-Test_12-12","ClientSubUnitGuid":"26:3J67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-13-13","ClientTopUnitGuid":"13:13","ClientSubUnitName":"CSU-Test_13-13","ClientSubUnitGuid":"27:3K68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-14-14","ClientTopUnitGuid":"14:14","ClientSubUnitName":"CSU-Test_14-14","ClientSubUnitGuid":"28:3K69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-15-15","ClientTopUnitGuid":"15:15","ClientSubUnitName":"CSU-Test_15-15","ClientSubUnitGuid":"29:3K70","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"pageNo":{"equalTo": "4"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-16-16","ClientTopUnitGuid":"16:16","ClientSubUnitName":"CSU-Test_16-16","ClientSubUnitGuid":"30:3K71","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-17-17","ClientTopUnitGuid":"17:17","ClientSubUnitName":"CSU-Test_17-17","ClientSubUnitGuid":"31:3K72","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-18-18","ClientTopUnitGuid":"18:18","ClientSubUnitName":"CSU-Test_18-18","ClientSubUnitGuid":"32:3K73","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-19-19","ClientTopUnitGuid":"19:19","ClientSubUnitName":"CSU-Test_19-19","ClientSubUnitGuid":"33:3K74","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-20-20","ClientTopUnitGuid":"20:20","ClientSubUnitName":"CSU-Test_20-20","ClientSubUnitGuid":"34:3K75","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"pageNo":{"equalTo": "5"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-21-21","ClientTopUnitGuid":"21:21","ClientSubUnitName":"CSU-Test_21-21","ClientSubUnitGuid":"35:3K76","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-22-22","ClientTopUnitGuid":"22:22","ClientSubUnitName":"CSU-Test_22-22","ClientSubUnitGuid":"36:3K77","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-23-23","ClientTopUnitGuid":"23:23","ClientSubUnitName":"CSU-Test_23-23","ClientSubUnitGuid":"37:3K78","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-24-24","ClientTopUnitGuid":"24:24","ClientSubUnitName":"CSU-Test_24-24","ClientSubUnitGuid":"38:3K79","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-25-25","ClientTopUnitGuid":"25:25","ClientSubUnitName":"CSU-Test_25-25","ClientSubUnitGuid":"39:3K80","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2017-01-01 00:00:00.000"},"pageNo":{"equalTo": "1"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-16-16","ClientTopUnitGuid":"16:16","ClientSubUnitName":"CSU-Test_16-16","ClientSubUnitGuid":"30:3K71","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-17-17","ClientTopUnitGuid":"17:17","ClientSubUnitName":"CSU-Test_17-17","ClientSubUnitGuid":"31:3K72","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-18-18","ClientTopUnitGuid":"18:18","ClientSubUnitName":"CSU-Test_18-18","ClientSubUnitGuid":"32:3K73","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-19-19","ClientTopUnitGuid":"19:19","ClientSubUnitName":"CSU-Test_19-19","ClientSubUnitGuid":"33:3K74","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-20-20","ClientTopUnitGuid":"20:20","ClientSubUnitName":"CSU-Test_20-20","ClientSubUnitGuid":"34:3K75","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"1970-01-01 00:00:00.000"},"EndTimestamp":{"equalTo":"2017-01-01 00:00:00.000"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-21-21","ClientTopUnitGuid":"21:21","ClientSubUnitName":"CSU-Test_21-21","ClientSubUnitGuid":"35:3K76","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-22-22","ClientTopUnitGuid":"22:22","ClientSubUnitName":"CSU-Test_22-22","ClientSubUnitGuid":"36:3K77","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-23-23","ClientTopUnitGuid":"23:23","ClientSubUnitName":"CSU-Test_23-23","ClientSubUnitGuid":"37:3K78","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-24-24","ClientTopUnitGuid":"24:24","ClientSubUnitName":"CSU-Test_24-24","ClientSubUnitGuid":"38:3K79","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-25-25","ClientTopUnitGuid":"25:25","ClientSubUnitName":"CSU-Test_25-25","ClientSubUnitGuid":"39:3K80","CountryCode":"US"}]}
    Create Error Stub For Endpoints For Client Config    204    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"matches":"^.+$"},"EndTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"pageNo":{"equalTo": "6"}},"method":"GET"}    response={"Code":202,"Error":"NO_DATA_FOUND","Description":"request did not yield any result"}
    Replace Strings In Variables    CONFIG::CLIENT::MAPPINGS_data,"14:3B67":"0:0",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"15:3C68":"1:1",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"16:3D69":"2:2",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"17:3E61":"3:3",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"18:3F62":"4:4",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"19:3G63":"5:5",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"20:3H64":"6:6",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"21:3I65":"7:7",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"22:3J66":"8:8",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"23:3K67":"9:9",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"40:3K81":"26:26",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"41:3K82":"27:27",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"42:3K83":"28:28",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"43:3K84":"29:29",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"44:3K85":"30:30",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"45:3K86":"31:31",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"46:3K87":"32:32",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"47:3K88":"33:33",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"48:3K89":"34:34",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"49:3K90":"35:35",${EMPTY}
    Trigger Lambda Function With Payload    ${config_data_lambda_func}    payload="{\\\"endTimestamp\\\":\\\"2018-01-01 00:00:00.000\\\",\\\"startPage\\\":3}"
    Verify That Redis Keys Are Correct    CONFIG::CLIENT::MAPPINGS|ETL::CLIENTCONFIG|CONFIG::CLIENT::LASTMODIFIED
    Verify Redis Hash Data    CONFIG::CLIENT::MAPPINGS
    Verify Redis List Data    ETL::CLIENTCONFIG,COMPLETE
    Verify Redis String Data    CONFIG::CLIENT::LASTMODIFIED    pattern=2018-01-01 00:00:00.000
    Send GET Request For Admin Clients
    Verify That Correct Client Data Is Returned    [{'clientTopGUID': '10:10', 'clientTopName': 'ClientTop-test-10-10', 'subunits': [{'clientSubGUID': '24:3D70', 'clientSubName': 'CSU-Test_10-10', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '11:11', 'clientTopName': 'ClientTop-test-11-11', 'subunits': [{'clientSubGUID': '25:3H65', 'clientSubName': 'CSU-Test_11-11', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '12:12', 'clientTopName': 'ClientTop-test-12-12', 'subunits': [{'clientSubGUID': '26:3J67', 'clientSubName': 'CSU-Test_12-12', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '13:13', 'clientTopName': 'ClientTop-test-13-13', 'subunits': [{'clientSubGUID': '27:3K68', 'clientSubName': 'CSU-Test_13-13', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '14:14', 'clientTopName': 'ClientTop-test-14-14', 'subunits': [{'clientSubGUID': '28:3K69', 'clientSubName': 'CSU-Test_14-14', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '15:15', 'clientTopName': 'ClientTop-test-15-15', 'subunits': [{'clientSubGUID': '29:3K70', 'clientSubName': 'CSU-Test_15-15', 'country': {'countryCode': 'US'}}]}{'clientTopGUID': '16:16', 'clientTopName': 'ClientTop-test-16-16', 'subunits': [{'clientSubGUID': '30:3K71', 'clientSubName': 'CSU-Test_16-16', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '17:17', 'clientTopName': 'ClientTop-test-17-17', 'subunits': [{'clientSubGUID': '31:3K72', 'clientSubName': 'CSU-Test_17-17', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '18:18', 'clientTopName': 'ClientTop-test-18-18', 'subunits': [{'clientSubGUID': '32:3K73', 'clientSubName': 'CSU-Test_18-18', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '19:19', 'clientTopName': 'ClientTop-test-19-19', 'subunits': [{'clientSubGUID': '33:3K74', 'clientSubName': 'CSU-Test_19-19', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '20:20', 'clientTopName': 'ClientTop-test-20-20', 'subunits': [{'clientSubGUID': '34:3K75', 'clientSubName': 'CSU-Test_20-20', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '21:21', 'clientTopName': 'ClientTop-test-21-21', 'subunits': [{'clientSubGUID': '35:3K76', 'clientSubName': 'CSU-Test_21-21', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '22:22', 'clientTopName': 'ClientTop-test-22-22', 'subunits': [{'clientSubGUID': '36:3K77', 'clientSubName': 'CSU-Test_22-22', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '23:23', 'clientTopName': 'ClientTop-test-23-23', 'subunits': [{'clientSubGUID': '37:3K78', 'clientSubName': 'CSU-Test_23-23', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '24:24', 'clientTopName': 'ClientTop-test-24-24', 'subunits': [{'clientSubGUID': '38:3K79', 'clientSubName': 'CSU-Test_24-24', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '25:25', 'clientTopName': 'ClientTop-test-25-25', 'subunits': [{'clientSubGUID': '39:3K80', 'clientSubName': 'CSU-Test_25-25', 'country': {'countryCode': 'US'}}]}]

FNC_011 Verify That Client Config Lambda With Powerbase API Is Triggered When StartTimestamp And endPage Is Specified In Payload
    Get Current Time With Pattern
    Flush All Redis Keys
    Delete Clients Collecton In MongoDB
    Create Success Stub For Powerbase API    request={"urlPattern":"${wiremock_pb_url}${pb_uri_oauth}.+","method":"POST"}    response=${pb_oauth_response}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "1"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-0-0","ClientTopUnitGuid":"0:0","ClientSubUnitName":"CSU-Test_0-0","ClientSubUnitGuid":"14:3B67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-1-1","ClientTopUnitGuid":"1:1","ClientSubUnitName":"CSU-Test_1-1","ClientSubUnitGuid":"15:3C68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-2-2","ClientTopUnitGuid":"2:2","ClientSubUnitName":"CSU-Test_2-2","ClientSubUnitGuid":"16:3D69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-3-3","ClientTopUnitGuid":"3:3","ClientSubUnitName":"CSU-Test_3-3","ClientSubUnitGuid":"17:3E61","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-4-4","ClientTopUnitGuid":"4:4","ClientSubUnitName":"CSU-Test_4-4","ClientSubUnitGuid":"18:3F62","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "2"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-5-5","ClientTopUnitGuid":"5:5","ClientSubUnitName":"CSU-Test_5-5","ClientSubUnitGuid":"19:3G63","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-6-6","ClientTopUnitGuid":"6:6","ClientSubUnitName":"CSU-Test_6-6","ClientSubUnitGuid":"20:3H64","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-7-7","ClientTopUnitGuid":"7:7","ClientSubUnitName":"CSU-Test_7-7","ClientSubUnitGuid":"21:3I65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-8-8","ClientTopUnitGuid":"8:8","ClientSubUnitName":"CSU-Test_8-8","ClientSubUnitGuid":"22:3J66","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-9-9","ClientTopUnitGuid":"9:9","ClientSubUnitName":"CSU-Test_9-9","ClientSubUnitGuid":"23:3K67","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "3"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-10-10","ClientTopUnitGuid":"10:10","ClientSubUnitName":"CSU-Test_10-10","ClientSubUnitGuid":"24:3D70","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-11-11","ClientTopUnitGuid":"11:11","ClientSubUnitName":"CSU-Test_11-11","ClientSubUnitGuid":"25:3H65","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-12-12","ClientTopUnitGuid":"12:12","ClientSubUnitName":"CSU-Test_12-12","ClientSubUnitGuid":"26:3J67","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-13-13","ClientTopUnitGuid":"13:13","ClientSubUnitName":"CSU-Test_13-13","ClientSubUnitGuid":"27:3K68","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-14-14","ClientTopUnitGuid":"14:14","ClientSubUnitName":"CSU-Test_14-14","ClientSubUnitGuid":"28:3K69","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-15-15","ClientTopUnitGuid":"15:15","ClientSubUnitName":"CSU-Test_15-15","ClientSubUnitGuid":"29:3K70","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "4"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-16-16","ClientTopUnitGuid":"16:16","ClientSubUnitName":"CSU-Test_16-16","ClientSubUnitGuid":"30:3K71","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-17-17","ClientTopUnitGuid":"17:17","ClientSubUnitName":"CSU-Test_17-17","ClientSubUnitGuid":"31:3K72","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-18-18","ClientTopUnitGuid":"18:18","ClientSubUnitName":"CSU-Test_18-18","ClientSubUnitGuid":"32:3K73","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-19-19","ClientTopUnitGuid":"19:19","ClientSubUnitName":"CSU-Test_19-19","ClientSubUnitGuid":"33:3K74","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-20-20","ClientTopUnitGuid":"20:20","ClientSubUnitName":"CSU-Test_20-20","ClientSubUnitGuid":"34:3K75","CountryCode":"US"}]}
    Create Success Stub For Powerbase API    request={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "5"}},"method":"GET"}    response={"ClientSubUnits":[{"ClientTopUnitName":"ClientTop-test-21-21","ClientTopUnitGuid":"21:21","ClientSubUnitName":"CSU-Test_21-21","ClientSubUnitGuid":"35:3K76","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-22-22","ClientTopUnitGuid":"22:22","ClientSubUnitName":"CSU-Test_22-22","ClientSubUnitGuid":"36:3K77","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-23-23","ClientTopUnitGuid":"23:23","ClientSubUnitName":"CSU-Test_23-23","ClientSubUnitGuid":"37:3K78","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-24-24","ClientTopUnitGuid":"24:24","ClientSubUnitName":"CSU-Test_24-24","ClientSubUnitGuid":"38:3K79","CountryCode":"US"},{"ClientTopUnitName":"ClientTop-test-25-25","ClientTopUnitGuid":"25:25","ClientSubUnitName":"CSU-Test_25-25","ClientSubUnitGuid":"39:3K80","CountryCode":"US"}]}
    Create Error Stub For Endpoints For Client Config    204    stub_url={"urlPath":"${wiremock_pb_url}${pb_uri_csu_updates}","queryParameters":{"StartTimestamp":{"equalTo":"2018-01-01 00:00:00.000"},"EndTimestamp":{"matches":"^.+$"},"pageNo":{"equalTo": "6"}},"method":"GET"}    response={"Code":202,"Error":"NO_DATA_FOUND","Description":"request did not yield any result"}
    Replace Strings In Variables    CONFIG::CLIENT::MAPPINGS_data,"30:3K71":"16:16",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"31:3K72":"17:17",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"32:3K73":"18:18",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"33:3K74":"19:19",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"34:3K75":"20:20",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"35:3K76":"21:21",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"36:3K77":"22:22",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"37:3K78":"23:23",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"38:3K79":"24:24",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"39:3K80":"25:25",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"40:3K81":"26:26",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"41:3K82":"27:27",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"42:3K83":"28:28",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"43:3K84":"29:29",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"44:3K85":"30:30",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"45:3K86":"31:31",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"46:3K87":"32:32",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"47:3K88":"33:33",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"48:3K89":"34:34",${EMPTY}|CONFIG::CLIENT::MAPPINGS_data,"49:3K90":"35:35",${EMPTY}
    Trigger Lambda Function With Payload    ${config_data_lambda_func}    payload="{\\\"startTimestamp\\\":\\\"2018-01-01 00:00:00.000\\\",\\\"endPage\\\":3}"
    Verify That Redis Keys Are Correct    CONFIG::CLIENT::MAPPINGS|ETL::CLIENTCONFIG|CONFIG::CLIENT::LASTMODIFIED
    Verify Redis Hash Data    CONFIG::CLIENT::MAPPINGS
    Verify Redis List Data    ETL::CLIENTCONFIG,COMPLETE
    Verify Redis String Data    CONFIG::CLIENT::LASTMODIFIED    pattern=${current_date_data}
    Send GET Request For Admin Clients
    Verify That Correct Client Data Is Returned    [{'clientTopGUID': '2:2', 'clientTopName': 'ClientTop-test-2-2', 'subunits': [{'clientSubGUID': '16:3D69', 'clientSubName': 'CSU-Test_2-2', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '7:7', 'clientTopName': 'ClientTop-test-7-7', 'subunits': [{'clientSubGUID': '21:3I65', 'clientSubName': 'CSU-Test_7-7', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '4:4', 'clientTopName': 'ClientTop-test-4-4', 'subunits': [{'clientSubGUID': '18:3F62', 'clientSubName': 'CSU-Test_4-4', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '9:9', 'clientTopName': 'ClientTop-test-9-9', 'subunits': [{'clientSubGUID': '23:3K67', 'clientSubName': 'CSU-Test_9-9', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '3:3', 'clientTopName': 'ClientTop-test-3-3', 'subunits': [{'clientSubGUID': '17:3E61', 'clientSubName': 'CSU-Test_3-3', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '8:8', 'clientTopName': 'ClientTop-test-8-8', 'subunits': [{'clientSubGUID': '22:3J66', 'clientSubName': 'CSU-Test_8-8', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '1:1', 'clientTopName': 'ClientTop-test-1-1', 'subunits': [{'clientSubGUID': '15:3C68', 'clientSubName': 'CSU-Test_1-1', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '6:6', 'clientTopName': 'ClientTop-test-6-6', 'subunits': [{'clientSubGUID': '20:3H64', 'clientSubName': 'CSU-Test_6-6', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '0:0', 'clientTopName': 'ClientTop-test-0-0', 'subunits': [{'clientSubGUID': '14:3B67', 'clientSubName': 'CSU-Test_0-0', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '5:5', 'clientTopName': 'ClientTop-test-5-5', 'subunits': [{'clientSubGUID': '19:3G63', 'clientSubName': 'CSU-Test_5-5', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '10:10', 'clientTopName': 'ClientTop-test-10-10', 'subunits': [{'clientSubGUID': '24:3D70', 'clientSubName': 'CSU-Test_10-10', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '11:11', 'clientTopName': 'ClientTop-test-11-11', 'subunits': [{'clientSubGUID': '25:3H65', 'clientSubName': 'CSU-Test_11-11', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '12:12', 'clientTopName': 'ClientTop-test-12-12', 'subunits': [{'clientSubGUID': '26:3J67', 'clientSubName': 'CSU-Test_12-12', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '13:13', 'clientTopName': 'ClientTop-test-13-13', 'subunits': [{'clientSubGUID': '27:3K68', 'clientSubName': 'CSU-Test_13-13', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '14:14', 'clientTopName': 'ClientTop-test-14-14', 'subunits': [{'clientSubGUID': '28:3K69', 'clientSubName': 'CSU-Test_14-14', 'country': {'countryCode': 'US'}}]},{'clientTopGUID': '15:15', 'clientTopName': 'ClientTop-test-15-15', 'subunits': [{'clientSubGUID': '29:3K70', 'clientSubName': 'CSU-Test_15-15', 'country': {'countryCode': 'US'}}]}]
